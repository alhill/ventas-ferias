{"version":3,"sources":["context/firebase.jsx","context/authentication.jsx","pages/Home.jsx","pages/Login.jsx","pages/Register.jsx","components/Container.jsx","components/ProductBtn.jsx","components/PackBtn.jsx","utils/estaSeguroDeQue.jsx","pages/Products.jsx","pages/Events.jsx","pages/Event.jsx","utils/basicSorter.jsx","pages/EventStatus.jsx","pages/NewSale.jsx","app.jsx","rootProviders.jsx","index.jsx"],"names":["firebaseConfig","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","REACT_APP_MESSAGING_SENDER_ID","appId","measurementId","firebaseApp","firebase","FirebaseContext","createContext","undefined","FirebaseProvider","children","firestore","getFirestore","auth","getAuth","useState","user","setUser","isFetchingUser","setIsFetchingUser","onAuthStateChanged","logoutUserFromFirebase","signOut","usersCollection","collection","Provider","value","createUserOnFirebase","email","password","Promise","resolve","reject","createUserWithEmailAndPassword","firebaseUser","doc","uid","set","doUserLoginOnFirebase","signInWithEmailAndPassword","useFirebase","context","useContext","Error","AuthenticationContext","AuthenticationProvider","getLoggedUser","doLogout","isLogged","doLogin","doRegister","useAuthentication","Home","history","useHistory","logout","push","to","onClick","type","Login","isSubmitting","setIsSubmitting","formValues","setFormValues","onSubmit","handleChange","e","target","name","style","display","flexDirection","htmlFor","required","id","onChange","width","disabled","Register","Header","styled","div","Body","Container","margin","padding","Wrapper","color","Qty","BtnWrap","ProductBtn","product","mutateStatus","qty","modalPack","setModalPack","firstTag","_","get","reduce","acc","it","charCodeAt","toString","textShadow","fontWeight","marginBottom","price","size","MinusOutlined","visible","pack","PlusOutlined","PackBtn","packItems","setPackItems","filter","length","idx","findIndex","i","units","estaSeguroDeQue","desea","esto","title","text","bypass","loading","safer","field","cancelText","fn","compare","toLocaleUpperCase","Modal","confirm","className","icon","ExclamationCircleOutlined","content","Item","evt","current","justifyContent","marginRight","destroyAll","message","warning","capitalize","onOk","okButtonProps","Products","mutateModal","setMutateModal","mutateModalPack","setMutateModalPack","products","setProducts","packs","setPacks","tags","setTags","selectedTags","setSelectedTags","selectedTagPack","setSelectedTagPack","setLoading","loadingPack","setLoadingPack","useEffect","unsubscribeProducts","onSnapshot","query","qs","docs","map","data","unsubscribePacks","getDoc","config","Form","useForm","form","formPack","createProduct","getFieldsValue","addDoc","parseFloat","success","console","log","error","updateProduct","setDoc","deleteProduct","deleteDoc","createPack","tag","updatePack","deletePack","columns","dataIndex","key","render","setFieldsValue","edit","EditOutlined","DeleteOutlined","columnsPack","onCancel","dataSource","rowKey","footer","layout","onFinish","label","rules","uniq","getFieldValue","Option","t","submit","resetFields","Events","events","setEvents","unsubscribeEvents","createEvent","date","toDate","updateEvent","moment","BtnWrapper","Event","useParams","event","setEvent","basicSorter","a","b","EventStatus","sales","setSales","total","setTotal","modalDetalle","setModalDetalle","unsubscribeSales","eventRaw","ref","seconds","format","sorter","createdAt","items","subItems","flat","item","populatedItem","find","p","EyeOutlined","paymentMethod","description","ProductWrapper","formEnd","filteredProducts","setFilteredProducts","selectedTag","setSelectedTag","saleStatus","setSaleStatus","modalPackSelector","setModalPackSelector","modalEndSale","setModalEndSale","modalTotal","setModalTotal","setPaymentMethod","inputMoney","setInputMoney","loadingSale","setLoadingSale","delta","oldQty","saleStatusMod","newQty","omit","includes","sort","filterByTag","calculateTotal","Object","entries","Group","flexWrap","Button","fp","newStatus","suffix","ss","isPack","sale","Date","docRef","colRef","App","AuthenticatedApp","path","exact","NewSale","UnauthenticatedApp","RootProvider","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.930f0dca.chunk.js","sourcesContent":["import React, { createContext, useContext, useState } from \"react\";\r\nimport * as firebase from \"firebase/app\";\r\nimport { getFirestore, collection } from 'firebase/firestore'\r\nimport { \r\n  getAuth, \r\n  onAuthStateChanged, \r\n  createUserWithEmailAndPassword, \r\n  signInWithEmailAndPassword \r\n} from 'firebase/auth'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_API_KEY,\r\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\r\n  // databaseURL: process.env.REACT_APP_DATABASE_URL,\r\n  projectId: process.env.REACT_APP_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_APP_ID,\r\n  measurementId: process.env.REACT_APP_MEASUREMENT_ID,\r\n};\r\n\r\nconst firebaseApp = firebase.initializeApp(firebaseConfig);\r\n\r\nconst FirebaseContext = createContext(undefined);\r\n\r\nfunction FirebaseProvider({ children }) {\r\n\r\n  const firestore = getFirestore(firebaseApp);\r\n  const auth = getAuth(firebaseApp);\r\n\r\n  // AUTHENTICATION\r\n  const [user, setUser] = useState(null);\r\n  const [isFetchingUser, setIsFetchingUser] = useState(true);\r\n\r\n  onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      setUser(user);\r\n    } else {\r\n      setUser(null);\r\n    }\r\n\r\n    setIsFetchingUser(false);\r\n  });\r\n\r\n  const createUserOnFirebase = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        const firebaseUser = await createUserWithEmailAndPassword(\r\n          auth,\r\n          email,\r\n          password\r\n        );\r\n\r\n        if (!firebaseUser.user) {\r\n          reject();\r\n          return;\r\n        }\r\n\r\n        await usersCollection.doc(firebaseUser.user.uid).set({\r\n          email: firebaseUser.user.email,\r\n        });\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const doUserLoginOnFirebase = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        await signInWithEmailAndPassword(auth, email, password);\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const logoutUserFromFirebase = async () => await auth.signOut();\r\n\r\n  // FIRESTORE\r\n  const usersCollection = collection(firestore, \"users\");\r\n\r\n  return (\r\n    <FirebaseContext.Provider\r\n      value={{\r\n        createUserOnFirebase,\r\n        doUserLoginOnFirebase,\r\n        logoutUserFromFirebase,\r\n        user,\r\n        firestore,\r\n        isFetchingUser,\r\n      }}\r\n    >\r\n      {children}\r\n    </FirebaseContext.Provider>\r\n  );\r\n}\r\n\r\nfunction useFirebase() {\r\n  const context = useContext(FirebaseContext);\r\n\r\n  if (context === undefined) {\r\n    throw new Error(\"useFirebase must be used within a FirebaseProvider\");\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\nexport { FirebaseProvider, useFirebase };\r\n","import React, { createContext, ReactNode, useContext } from \"react\";\r\nimport { useFirebase } from \"./firebase\";\r\n\r\n\r\nconst AuthenticationContext = createContext(undefined);\r\n\r\nconst AuthenticationProvider = ({ children }) => {\r\n  const {\r\n    createUserOnFirebase,\r\n    doUserLoginOnFirebase,\r\n    logoutUserFromFirebase,\r\n    user,\r\n    isFetchingUser,\r\n  } = useFirebase();\r\n\r\n  const getLoggedUser = () => user;\r\n\r\n  const doLogin = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        await doUserLoginOnFirebase(email, password);\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const doRegister = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        await createUserOnFirebase(email, password);\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const doLogout = async () => await logoutUserFromFirebase();\r\n\r\n  return (\r\n    <AuthenticationContext.Provider\r\n      value={{\r\n        isLogged: !!getLoggedUser(),\r\n        user: getLoggedUser(),\r\n        isFetchingUser,\r\n        doLogin,\r\n        doRegister,\r\n        doLogout,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthenticationContext.Provider>\r\n  );\r\n};\r\n\r\nconst useAuthentication = () => {\r\n  const context = useContext(AuthenticationContext);\r\n\r\n  if (context === undefined) {\r\n    throw new Error(\r\n      \"useAuthentication must be used within a AuthenticationProvider\"\r\n    );\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\nexport { AuthenticationProvider, useAuthentication };\r\n","import React from \"react\";\r\nimport { useAuthentication } from \"../context/authentication\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\n\r\nconst Home = () => {\r\n  const history = useHistory();\r\n  const { doLogout, user } = useAuthentication();\r\n\r\n  const logout = async () => {\r\n    await doLogout();\r\n    history.push(\"/login\");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <h1>Holas {user?.email} :)</h1>\r\n      <div>\r\n        <Link to=\"/eventos\"><button>Eventos</button></Link>\r\n        <Link to=\"/productos\"><button>Productos</button></Link>\r\n      </div>\r\n      <button onClick={logout} type=\"button\">\r\n        Logout\r\n      </button>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Home\r\n","import React, { useState } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport { useAuthentication } from \"../context/authentication\";\r\n\r\nconst Login = () => {\r\n  const { push } = useHistory();\r\n  const { doLogin } = useAuthentication();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [formValues, setFormValues] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const onSubmit = async () => {\r\n    const { email, password } = formValues;\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n\r\n      await doLogin(email, password);\r\n\r\n      push(\"/\");\r\n    } catch (e) {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = e => {\r\n    setFormValues({\r\n      ...formValues,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <form>\r\n      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n        <div>\r\n          <label htmlFor=\"email\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            required\r\n            id=\"email\"\r\n            name=\"email\"\r\n            value={formValues.email}\r\n            onChange={handleChange}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"password\">Password</label>\r\n          <input\r\n            type=\"password\"\r\n            required\r\n            id=\"password\"\r\n            name=\"password\"\r\n            value={formValues.password}\r\n            onChange={handleChange}\r\n          />\r\n        </div>\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            width: \"fit-content\",\r\n          }}\r\n        >\r\n          <button type=\"submit\" disabled={isSubmitting} onClick={onSubmit}>\r\n            {isSubmitting ? \"logging...\" : \"login\"}\r\n          </button>\r\n          <Link to=\"/register\">I don't have an account yet!</Link>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Login\r\n","import React, { useState } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport { useAuthentication } from \"../context/authentication\";\r\n\r\nconst Register = () => {\r\n  const { push } = useHistory();\r\n  const { doRegister } = useAuthentication();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [formValues, setFormValues] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const onSubmit = async () => {\r\n    const { email, password } = formValues;\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n\r\n      await doRegister(email, password);\r\n\r\n      push(\"/\");\r\n    } catch (e) {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = e => {\r\n    setFormValues({\r\n      ...formValues,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <form>\r\n      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n        <div>\r\n          <label htmlFor=\"email\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            required\r\n            id=\"email\"\r\n            name=\"email\"\r\n            value={formValues.email}\r\n            onChange={handleChange}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"password\">Password</label>\r\n          <input\r\n            type=\"password\"\r\n            required\r\n            id=\"password\"\r\n            name=\"password\"\r\n            value={formValues.password}\r\n            onChange={handleChange}\r\n          />\r\n        </div>\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            width: \"fit-content\",\r\n          }}\r\n        >\r\n          <button disabled={isSubmitting} onClick={onSubmit}>\r\n            {isSubmitting ? \"registering...\" : \"register\"}\r\n          </button>\r\n          <Link to=\"/login\">I already have an account</Link>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Register\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button } from 'antd'\r\nimport { Link } from 'react-router-dom'\r\n\r\nconst Container = ({ children }) => {\r\n    return <div>\r\n        <Header>\r\n            <h3 style={{ margin: 0, padding: 0 }}>La buena feria</h3>\r\n            <div>\r\n                <Link to=\"/productos\"><Button>Productos</Button></Link>\r\n                <Link to=\"/eventos\"><Button>Eventos</Button></Link>\r\n            </div>\r\n        </Header>\r\n        <Body>\r\n            { children }\r\n        </Body>\r\n    </div>\r\n}\r\n\r\nconst Header = styled.div`\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background-color: #d7ffea;\r\n    height: 40px;\r\n    border-bottom: 1px solid gainsboro;\r\n    box-shadow: 0px 2px 4px 1px rgba(0, 0, 0, 0.1);\r\n    padding: 0 1em;\r\n`\r\nconst Body = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    margin: 1em;\r\n    width: calc(100% - 2em);\r\n`\r\n\r\nexport default Container","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button, Tag } from 'antd'\r\nimport { MinusOutlined, PlusOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash'\r\n\r\nconst ProductBtn = ({ product, mutateStatus, qty, modalPack, setModalPack }) => {\r\n    const firstTag = _.get(product, \"tags[0]\", \"\") \r\n    const color = firstTag ? ([...firstTag].reduce((acc, it) => acc * it.charCodeAt(), 123123) % 16777215).toString(16) : \"FFFFFF\"\r\n    return (\r\n        <Wrapper color={\"#\" + color}>\r\n            <Qty>\r\n                {!!qty && <Tag>{ qty?.qty || qty }</Tag>}\r\n            </Qty>\r\n\r\n            <p style={{\r\n                textShadow: \"0px 0px 8px white\",\r\n                fontWeight: \"bold\",\r\n                marginBottom: \"6px\"\r\n            }}>{ product.name }</p>\r\n            {(qty?.qty || qty) > 0 && <strong>{(qty?.qty || qty) * product.price }€</strong> }\r\n\r\n            <BtnWrap>\r\n                <Button \r\n                    disabled={qty < 1}\r\n                    size='small' \r\n                    onClick={() => mutateStatus(product.id, -1, !!modalPack)}\r\n                >\r\n                    <MinusOutlined />\r\n                </Button>\r\n                <Button \r\n                    size='small' \r\n                    onClick={() => {\r\n                        if(modalPack){\r\n                            setModalPack({\r\n                                visible: true,\r\n                                pack: product\r\n                            })\r\n                        } else {\r\n                            mutateStatus(product.id, 1)\r\n                        }\r\n                    }}\r\n                >\r\n                    <PlusOutlined />\r\n                </Button>\r\n            </BtnWrap>\r\n        </Wrapper>\r\n    )\r\n}\r\n\r\nconst Wrapper = styled.div`\r\n    width: 105px;\r\n    height: 140px;\r\n    border-radius: 4px;\r\n    border: 1px solid gainsboro;\r\n    margin: 4px;\r\n    position: relative;\r\n    padding: 1em;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    background-color: ${({ color }) => color};\r\n\r\n`\r\n\r\nconst Qty = styled.div`\r\n    position: absolute;\r\n    top: -6px;\r\n    right: -14px;\r\n`\r\n\r\nconst BtnWrap = styled.div`\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n`\r\n\r\nexport default ProductBtn","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button, Tag } from 'antd'\r\nimport { MinusOutlined, PlusOutlined } from '@ant-design/icons'\r\n\r\nconst PackBtn = ({ product, pack, packItems, setPackItems }) => {\r\n    const qty = packItems.filter(it => it === product?.id)?.length\r\n\r\n    return (\r\n        <Wrapper>\r\n            <Qty><Tag>{ qty }</Tag></Qty>\r\n\r\n            { product.name }\r\n\r\n            <BtnWrap>\r\n                <Button \r\n                    disabled={packItems?.length < 0}\r\n                    size='small' \r\n                    onClick={() => {\r\n                        const idx = packItems.findIndex(it => it === product.id)\r\n                        setPackItems(packItems.filter((it, i) => i !== idx))\r\n                    }}\r\n                >\r\n                    <MinusOutlined />\r\n                </Button>\r\n                <Button \r\n                    disabled={packItems?.length >= pack?.units}\r\n                    size='small' \r\n                    onClick={() => {\r\n                        setPackItems([\r\n                            ...packItems,\r\n                            product.id\r\n                        ])\r\n                    }}\r\n                >\r\n                    <PlusOutlined />\r\n                </Button>\r\n            </BtnWrap>\r\n        </Wrapper>\r\n    )\r\n}\r\n\r\nconst Wrapper = styled.div`\r\n    width: 110px;\r\n    height: 110px;\r\n    border-radius: 4px;\r\n    border: 1px solid gainsboro;\r\n    margin: 4px;\r\n    position: relative;\r\n    padding: 1em;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n\r\n`\r\n\r\nconst Qty = styled.div`\r\n    position: absolute;\r\n    top: -6px;\r\n    right: -14px;\r\n`\r\n\r\nconst BtnWrap = styled.div`\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n`\r\n\r\nexport default PackBtn","import React from 'react'\r\nimport { Input, Modal, Form, Button, message } from 'antd'\r\nimport { capitalize } from 'lodash'\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons'\r\n\r\n//Enola Gay, is mother proud of little boy today? \r\nconst estaSeguroDeQue = ({ desea, esto, title, text, bypass, loading, safer, field, cancelText, fn }) => {\r\n\r\n    const compare = safer ? (desea + \" \" + esto).toLocaleUpperCase() : \"\"\r\n\r\n    if(!bypass){\r\n        Modal.confirm({\r\n            className: \"customConfirm\",\r\n            icon: <ExclamationCircleOutlined color=\"#FFAB24\" />,\r\n            title: title ? title : `¿Está seguro de que desea ${desea} ${esto}?`,\r\n            content: <div>\r\n                <p>{text}</p>\r\n                { safer && <>\r\n                    <br />\r\n                    <p>Si quieres continuar, escribe \"{compare}\" en el campo que tienes a continuación</p>\r\n                    <Form.Item>\r\n                        <Input onChange={evt => field.current = evt.target.value}/>\r\n                    </Form.Item>\r\n                </>}\r\n                <br />\r\n                <div style={{ display: \"flex\", justifyContent: \"flex-end\"}}>\r\n                    <Button style={{ marginRight: \"1em\" }} onClick={() => Modal.destroyAll()}>{cancelText || \"Cancelar\"}</Button>\r\n                    <Button type=\"primary\" onClick={() => {\r\n                        if(safer){\r\n                            if(!field){\r\n                                throw new Error(\"Para usar la opción safer hay que pasar un ref de tipo string en el prop field `const fieldRef = useRef<string>(\\\"\\\")`\")\r\n                            }\r\n                            if(compare === (field.current || \"\").toLocaleUpperCase()){\r\n                                fn()\r\n                                field.current = \"\"\r\n                                Modal.destroyAll()\r\n                            } else {\r\n                                message.warning(\"Introduzca el texto de confirmación\")\r\n                            }\r\n                        } else {\r\n                            fn()\r\n                            Modal.destroyAll()\r\n                        }\r\n                    }}>{ capitalize(desea) || \"Aceptar\" }</Button>\r\n                </div>\r\n            </div>,\r\n            onOk: () => {},\r\n            okButtonProps: { loading }\r\n        })\r\n    } else {\r\n        fn()\r\n    }\r\n}\r\n\r\nexport default estaSeguroDeQue","import { Button, Modal, Input, Table, Tag, Form, Select, message } from 'antd'\r\nimport { collection, query, doc, getDocs, getDoc, addDoc, setDoc, deleteDoc, onSnapshot } from \"firebase/firestore\";\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase';\r\nimport { DeleteOutlined, EditOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash';\r\nimport estaSeguroDeQue from '../utils/estaSeguroDeQue';\r\n\r\nconst Products = () => {\r\n    const { firestore } = useFirebase()\r\n\r\n    const [mutateModal, setMutateModal] = useState({ visible: false })\r\n    const [mutateModalPack, setMutateModalPack] = useState({ visible: false })\r\n    const [products, setProducts] = useState([])\r\n    const [packs, setPacks] = useState([])\r\n    const [tags, setTags] = useState([])\r\n    const [selectedTags, setSelectedTags] = useState([])\r\n    const [selectedTagPack, setSelectedTagPack] = useState()\r\n    const [loading, setLoading] = useState(false)\r\n    const [loadingPack, setLoadingPack] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n        const unsubscribePacks = onSnapshot(\r\n            query(collection(firestore, \"packs\")),\r\n            qs => {\r\n                const packs = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setPacks(packs)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setTags(tags)\r\n        })()\r\n        \r\n        return () => {\r\n            unsubscribeProducts()\r\n            unsubscribePacks()\r\n        }\r\n    }, [])\r\n\r\n    const [form] = Form.useForm()\r\n    const [formPack] = Form.useForm()\r\n\r\n    const createProduct = async () => {\r\n        try{\r\n            setLoading(true)\r\n            // const { name, tags, price1, price2 } = form.getFieldsValue(true)\r\n            const { name, tags, price } = form.getFieldsValue(true)\r\n            const added = await addDoc(collection(firestore, \"products\"), {\r\n                name,\r\n                tags,\r\n                price: parseFloat(price)\r\n                // price: [price1, price2].filter(e => e)\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El producto se ha creado correctamente\")\r\n            setLoading(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la creación del producto\")\r\n        }\r\n    }\r\n    const updateProduct = async id => {\r\n        try{\r\n            setLoading(true)\r\n            const { name, tags, price } = form.getFieldsValue(true)\r\n            const updated = await setDoc(doc(firestore, \"products\", id), {\r\n                name,\r\n                tags,\r\n                price: parseFloat(price)\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El producto se ha editado correctamente\")\r\n            setLoading(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la edición del producto\")\r\n        }\r\n    }\r\n    const deleteProduct = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"products\", id))\r\n            message.success(\"El producto se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado del producto\")\r\n        }\r\n    }\r\n\r\n    const createPack = async () => {\r\n        try{\r\n            setLoadingPack(true)\r\n            // const { name, tags, price1, price2 } = form.getFieldsValue(true)\r\n            const { name, tag, price, units } = formPack.getFieldsValue(true)\r\n            const added = await addDoc(collection(firestore, \"packs\"), {\r\n                name,\r\n                tag,\r\n                price: parseFloat(price),\r\n                units\r\n                // price: [price1, price2].filter(e => e)\r\n            })\r\n            setMutateModalPack({ visible: false })\r\n            message.success(\"El pack se ha creado correctamente\")\r\n            setLoadingPack(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la creación del pack\")\r\n        }\r\n    }\r\n    const updatePack = async id => {\r\n        try{\r\n            setLoadingPack(true)\r\n            const { name, tag, price, units } = formPack.getFieldsValue(true)\r\n            const updated = await setDoc(doc(firestore, \"packs\", id), {\r\n                name,\r\n                tag,\r\n                price: parseFloat(price),\r\n                units\r\n            })\r\n            setMutateModalPack({ visible: false })\r\n            message.success(\"El pack se ha editado correctamente\")\r\n            setLoadingPack(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la edición del pack\")\r\n        }\r\n    }\r\n    const deletePack = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"packs\", id))\r\n            message.success(\"El pack se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado del pack\")\r\n        }\r\n    }\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\"\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: it => {\r\n                return (\r\n                    <div>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                form.setFieldsValue({\r\n                                    name: it.name,\r\n                                    price: it.price,\r\n                                    tags: it.tags\r\n                                })\r\n                                setSelectedTags(it.tags)\r\n                                setMutateModal({\r\n                                    visible: true,\r\n                                    edit: true,\r\n                                    id: it.id\r\n                                })\r\n                            }}\r\n                        ><EditOutlined /></Tag>\r\n                        &nbsp;\r\n                        <Tag \r\n                            color=\"volcano\"\r\n                            onClick={() => {\r\n                                estaSeguroDeQue({\r\n                                    desea: \"eliminar\",\r\n                                    esto: it.name,\r\n                                    loading,\r\n                                    fn: async () => {\r\n                                        setLoading(true)\r\n                                        await deleteProduct(it.id)\r\n                                        setLoading(false)\r\n                                    }\r\n                                })\r\n                            }}\r\n                        ><DeleteOutlined /></Tag>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n\r\n    const columnsPack = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\"\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: it => {\r\n                return (\r\n                    <div>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                formPack.setFieldsValue({\r\n                                    name: it.name,\r\n                                    price: it.price,\r\n                                    tag: it.tag,\r\n                                    units: it.units\r\n                                })\r\n                                setSelectedTagPack(it.tag)\r\n                                setMutateModalPack({\r\n                                    visible: true,\r\n                                    edit: true,\r\n                                    id: it.id\r\n                                })\r\n                            }}\r\n                        ><EditOutlined /></Tag>\r\n                        &nbsp;\r\n                        <Tag \r\n                            color=\"volcano\"\r\n                            onClick={() => {\r\n                                estaSeguroDeQue({\r\n                                    desea: \"eliminar\",\r\n                                    esto: it.name,\r\n                                    loading,\r\n                                    fn: async () => {\r\n                                        setLoadingPack(true)\r\n                                        await deletePack(it.id)\r\n                                        setLoadingPack(false)\r\n                                    }\r\n                                })\r\n                            }}\r\n                        ><DeleteOutlined /></Tag>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n    return (\r\n        <Container>\r\n            <h2>Productos</h2>\r\n            <Button \r\n                onClick={() => setMutateModal({ visible: true, edit: false })}\r\n                onCancel={() => setMutateModal({ visible: false })}\r\n                style={{ marginBottom: \"1em\" }}\r\n            >Crear producto</Button>\r\n\r\n            <div style={{ width: \"100%\" }}>\r\n                <Table\r\n                    dataSource={products}\r\n                    rowKey=\"id\"\r\n                    columns={columns}\r\n                />\r\n            </div>\r\n\r\n            <h2>Packs</h2>\r\n            <Button \r\n                onClick={() => setMutateModalPack({ visible: true, edit: false })}\r\n                onCancel={() => setMutateModalPack({ visible: false })}\r\n                style={{ marginBottom: \"1em\" }}\r\n            >Crear pack</Button>\r\n\r\n            <div style={{ width: \"100%\" }}>\r\n                <Table\r\n                    dataSource={packs}\r\n                    rowKey=\"id\"\r\n                    columns={columnsPack}\r\n                />\r\n            </div>\r\n\r\n            <Modal \r\n                visible={mutateModal.visible}\r\n                onCancel={() => setMutateModal({ visible: false })}\r\n                onOk={() => mutateModal?.edit ? updateProduct(mutateModal?.id) : createProduct()}\r\n                footer={null}\r\n            >\r\n                <h3>{mutateModal?.edit ? \"Editar producto\" : \"Nuevo producto\"}</h3>\r\n                <Form\r\n                    form={form}\r\n                    layout=\"vertical\"\r\n                    onFinish={() => mutateModal?.edit ? updateProduct(mutateModal?.id) : createProduct()}\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"price\"\r\n                        label=\"Precio\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input type=\"number\"/>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        label=\"Etiquetas\"\r\n                    >\r\n                        <Select\r\n                            onChange={it => {\r\n                                const tags = _.uniq([\r\n                                    ...(form.getFieldValue(\"tags\") || []),\r\n                                    it\r\n                                ])\r\n                                form.setFieldsValue({ tags })\r\n                                setSelectedTags(tags)\r\n                            }}\r\n                        >\r\n                            { tags.map((tag, i) => {\r\n                                return (\r\n                                    <Select.Option value={tag} key={\"tag-option\" + i}>{ tag }</Select.Option>\r\n                                )\r\n                            })}\r\n                        </Select>\r\n                        {(selectedTags || []).map((tag, i) => {\r\n                            return (\r\n                                <Tag key={\"tag\"+i} onClick={() => {\r\n                                    const tags = form.getFieldValue(\"tags\").filter(t => t !== tag)\r\n                                    form.setFieldsValue({ tags })\r\n                                    setSelectedTags(tags)\r\n                                }}>{tag} &times;</Tag>\r\n                            )\r\n                        })}\r\n                    </Form.Item>\r\n                </Form>\r\n                <div>\r\n                    <Button \r\n                        type=\"primary\" \r\n                        loading={loading} \r\n                        onClick={() => form.submit()}\r\n                    >{ mutateModal?.edit ? \"Editar\" : \"Crear\" }</Button>\r\n                    &nbsp;&nbsp;\r\n                    <Button onClick={() => {\r\n                        form.resetFields()\r\n                        setLoading(false)\r\n                        setMutateModal({ visible: false })\r\n                    }}>Cancelar</Button>\r\n                </div>\r\n            </Modal>\r\n\r\n            \r\n            <Modal \r\n                visible={mutateModalPack.visible}\r\n                onCancel={() => setMutateModalPack({ visible: false })}\r\n                onOk={() => mutateModalPack?.edit ? updatePack(mutateModalPack?.id) : createPack()}\r\n                footer={null}\r\n            >\r\n                <h3>{mutateModalPack?.edit ? \"Editar pack\" : \"Nuevo pack\"}</h3>\r\n                <Form\r\n                    form={formPack}\r\n                    layout=\"vertical\"\r\n                    onFinish={() => mutateModalPack?.edit ? updatePack(mutateModalPack?.id) : createPack()}\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre del pack\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"price\"\r\n                        label=\"Precio\"\r\n                        type=\"number\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input type=\"number\"/>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"units\"\r\n                        label=\"Unidades\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input type=\"number\"/>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        label=\"Etiqueta\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Select \r\n                            onChange={tag => {\r\n                                setSelectedTagPack(tag)\r\n                                formPack.setFieldsValue({ tag })\r\n                            }}\r\n                            value={selectedTagPack}\r\n                        >\r\n\r\n                            { tags.map((tag, i) => {\r\n                                return (\r\n                                    <Select.Option value={tag} key={\"tag-option\" + i}>{ tag }</Select.Option>\r\n                                )\r\n                            })}\r\n                        </Select>\r\n                    </Form.Item>\r\n                </Form>\r\n                <div>\r\n                    <Button \r\n                        type=\"primary\" \r\n                        loading={loadingPack} \r\n                        onClick={() => formPack.submit()}\r\n                    >{ mutateModalPack?.edit ? \"Editar\" : \"Crear\" }</Button>\r\n                    &nbsp;&nbsp;\r\n                    <Button onClick={() => {\r\n                        formPack.resetFields()\r\n                        setLoadingPack(false)\r\n                        setMutateModalPack({ visible: false })\r\n                    }}>Cancelar</Button>\r\n                </div>\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Products","import { Button, Modal, Input, Table, Tag, Form, Select, message, DatePicker, Switch } from 'antd'\r\nimport { collection, query, doc, getDocs, getDoc, addDoc, setDoc, deleteDoc, onSnapshot } from \"firebase/firestore\";\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase';\r\nimport { DeleteOutlined, EditOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash';\r\nimport estaSeguroDeQue from '../utils/estaSeguroDeQue';\r\nimport { useHistory, Link } from 'react-router-dom';\r\nimport moment from 'moment'\r\n\r\nconst Events = () => {\r\n    const { firestore } = useFirebase()\r\n    const history = useHistory()\r\n\r\n    const [mutateModal, setMutateModal] = useState({ visible: false })\r\n    const [events, setEvents] = useState([])\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const unsubscribeEvents = onSnapshot(\r\n            query(collection(firestore, \"events\")),\r\n            qs => {\r\n                const events = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setEvents(events)\r\n            }\r\n        )\r\n        return () => unsubscribeEvents()\r\n    }, [])\r\n\r\n    const [form] = Form.useForm()\r\n\r\n    const createEvent = async () => {\r\n        try{\r\n            setLoading(true)\r\n            const { name, date } = form.getFieldsValue(true)\r\n            const added = await addDoc(collection(firestore, \"events\"), {\r\n                name,\r\n                date: date.toDate()\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El evento se ha creado correctamente\")\r\n            setLoading(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la creación del evento\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n    const updateEvent = async id => {\r\n        try{\r\n            setLoading(true)\r\n            const { name, date } = form.getFieldsValue(true)\r\n            const updated = await setDoc(doc(firestore, \"events\", id), {\r\n                name,\r\n                date: date.toDate()\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El evento se ha editado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la edición del evento\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n    const deleteEvent = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"events\", id))\r\n            message.success(\"El evento se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado del evento\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\"\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: it => {\r\n                return (\r\n                    <div>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                console.log(it)\r\n                                form.setFieldsValue({\r\n                                    name: it.name,\r\n                                    date: moment(it.date.toDate())\r\n                                })\r\n                                setMutateModal({\r\n                                    visible: true,\r\n                                    edit: true,\r\n                                    id: it.id\r\n                                })\r\n                            }}\r\n                        ><EditOutlined /></Tag>\r\n                        {/* &nbsp;\r\n                        <Tag \r\n                            color=\"volcano\"\r\n                            onClick={() => {\r\n                                estaSeguroDeQue({\r\n                                    desea: \"eliminar\",\r\n                                    esto: it.name,\r\n                                    loading,\r\n                                    fn: async () => {\r\n                                        setLoading(true)\r\n                                        await deleteEvent(it.id)\r\n                                        setLoading(false)\r\n                                    }\r\n                                })\r\n                            }}\r\n                        ><DeleteOutlined /></Tag> */}\r\n                    </div>\r\n                )\r\n            }\r\n        },\r\n        {  \r\n            title: \"\",\r\n            render: evt => {\r\n                return (\r\n                    <Link to={`/eventos/${evt.id}`}>\r\n                        <Button \r\n                            type=\"primary\"\r\n                        >Entrar</Button>\r\n                    </Link>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n    return (\r\n        <Container>\r\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", width: \"100%\" }}>\r\n                <h2>Eventos</h2>\r\n                <Button\r\n                    onClick={() => setMutateModal({ visible: true, edit: false })}\r\n                    onCancel={() => setMutateModal({ visible: false })}\r\n                >Crear evento</Button>\r\n            </div>\r\n\r\n            <div\r\n                style={{ width: \"100%\" }}\r\n            >\r\n                <Table\r\n                    dataSource={events}\r\n                    rowKey=\"id\"\r\n                    columns={columns}\r\n                />\r\n            </div>\r\n            <Modal \r\n                visible={mutateModal.visible}\r\n                onCancel={() => setMutateModal({ visible: false })}\r\n                onOk={() => mutateModal?.edit ? updateEvent(mutateModal?.id) : createEvent()}\r\n                footer={null}\r\n            >\r\n                <h3>{mutateModal?.edit ? \"Editar evento\" : \"Nuevo evento\"}</h3>\r\n                <Form\r\n                    form={form}\r\n                    layout=\"vertical\"\r\n                    onFinish={() => mutateModal?.edit ? updateEvent(mutateModal?.id) : createEvent()}\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"date\"\r\n                        label=\"Fecha\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <DatePicker />\r\n                    </Form.Item>\r\n                </Form>\r\n                <div>\r\n                    <Button \r\n                        type=\"primary\" \r\n                        loading={loading} \r\n                        onClick={() => form.submit()}\r\n                    >{ mutateModal?.edit ? \"Editar\" : \"Crear\" }</Button>\r\n                    &nbsp;&nbsp;\r\n                    <Button onClick={() => {\r\n                        form.resetFields()\r\n                        setLoading(false)\r\n                        setMutateModal({ visible: false })\r\n                    }}>Cancelar</Button>\r\n                </div>\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Events","import { getDoc, query, collection, getDocs, onSnapshot, doc } from 'firebase/firestore'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase'\r\nimport { Button } from 'antd'\r\nimport { useParams, Link } from 'react-router-dom'\r\nimport styled from 'styled-components'\r\n\r\nconst Event = () => {\r\n\r\n    const { firestore } = useFirebase()\r\n    const { id } = useParams()\r\n\r\n    const [products, setProducts] = useState([])\r\n    const [event, setEvent] = useState()\r\n    const [tags, setTags] = useState([])\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const event = (await getDoc(doc(collection(firestore, \"events\"), id))).data()\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setEvent(event)\r\n            setTags(tags)\r\n        })()\r\n\r\n        return () => unsubscribeProducts()\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <Container>\r\n            <h2>Evento {event?.name}</h2>\r\n\r\n            <BtnWrapper>\r\n                <Link to={`/eventos/${id}/nueva-venta`}><Button>Nueva venta</Button></Link>\r\n                <Link to={`/eventos/${id}/resumen`}><Button>Ver resumen</Button></Link>\r\n            </BtnWrapper>\r\n        </Container>\r\n    )\r\n}\r\n\r\nconst BtnWrapper = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    width: 100%;\r\n    justify-content: space-evenly;\r\n\r\n`\r\n\r\nexport default Event","import { get } from 'lodash'\r\n\r\nconst basicSorter = (a, b, key) => {\r\n    const aValue = key ? get(a, key) : a\r\n    const bValue = key ? get(b, key) : b\r\n    if(aValue > bValue){ return 1 }\r\n    else{ return -1 }\r\n}\r\n\r\nexport default basicSorter","import { getDoc, query, collection, getDocs, onSnapshot, doc } from 'firebase/firestore'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase'\r\nimport { useParams, Link } from 'react-router-dom'\r\nimport { Button, Modal, Table } from 'antd'\r\nimport moment from 'moment'\r\nimport { EyeOutlined } from '@ant-design/icons'\r\nimport { basicSorter } from '../utils'\r\n\r\nconst EventStatus = () => {\r\n\r\n    const { firestore } = useFirebase()\r\n    const { id } = useParams()\r\n\r\n    const [products, setProducts] = useState([])\r\n    const [packs, setPacks] = useState([])\r\n    const [sales, setSales] = useState([])\r\n    const [event, setEvent] = useState()\r\n    const [tags, setTags] = useState([])\r\n    const [total, setTotal] = useState()\r\n    const [modalDetalle, setModalDetalle] = useState({\r\n        visible: false\r\n    })\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n        const unsubscribePacks = onSnapshot(\r\n            query(collection(firestore, \"packs\")),\r\n            qs => {\r\n                const packs = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setPacks(packs)\r\n            }\r\n        );\r\n        const unsubscribeSales = onSnapshot(\r\n            query(collection(firestore, `events/${id}/sales`)),\r\n            qs => {\r\n                const sales = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setSales(sales)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const eventRaw = (await getDoc(doc(collection(firestore, \"events\"), id)))\r\n            const event = {\r\n                id: eventRaw.id,\r\n                ref: eventRaw.ref,\r\n                ...eventRaw.data()\r\n            }\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setEvent(event)\r\n            setTags(tags)\r\n        })()\r\n\r\n        return () => {\r\n            unsubscribeProducts()\r\n            unsubscribePacks()\r\n            unsubscribeSales()\r\n        }\r\n    }, [])\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Fecha\",\r\n            dataIndex: \"createdAt\",\r\n            key: \"date\",\r\n            render: date => moment(date.seconds * 1000).format(\"DD-MM-YYYY HH:mm\"),\r\n            sorter: (a, b) => basicSorter(a?.createdAt, b?.createdAt, \"seconds\")\r\n        },\r\n        {\r\n            title: \"Nº artículos\",\r\n            dataIndex: \"items\",\r\n            key: \"items\",\r\n            render: items => {\r\n                const allItems = items.map(it => it?.subItems ? it.subItems : it).flat()\r\n                return allItems.length\r\n            }\r\n        },\r\n        {\r\n            title: \"Importe\",\r\n            dataIndex: \"total\",\r\n            key: \"total\",\r\n            render: total => total + \"€\",\r\n            sorter: (a, b) => basicSorter(a, b, \"total\")\r\n        },\r\n        {\r\n            key: \"detalleBtn\",\r\n            render: item => (\r\n                <Button\r\n                    onClick={() => {\r\n                        const populatedItem = {\r\n                            ...item,\r\n                            items: (item?.items || []).map(it => {\r\n                                return {\r\n                                    ...it,\r\n                                    name: products.find(p => p.id === it.id)?.name\r\n                                }\r\n                            })\r\n                        }\r\n                        setModalDetalle({\r\n                            visible: true,\r\n                            item: populatedItem\r\n                        })\r\n                    }}\r\n                ><EyeOutlined /></Button>\r\n            )\r\n        }\r\n    ]\r\n\r\n    useEffect(() => {\r\n        const total = sales.reduce((acc, it) => {\r\n            return acc + it?.total\r\n        }, 0)\r\n        setTotal(total + \"€\")\r\n    }, [sales])\r\n\r\n    return (\r\n        <Container>\r\n            <Link to={`/eventos/${id}`}>&lt; Volver</Link>\r\n            <h2>Resumen {event?.name}</h2>\r\n\r\n            <h4>Total: {total}</h4>\r\n            <Table\r\n                columns={columns}\r\n                dataSource={sales}\r\n                rowKey=\"id\"\r\n            />\r\n\r\n            {/* Modal detalle */}\r\n            <Modal\r\n                visible={modalDetalle?.visible}\r\n                footer={null}\r\n                onCancel={() => setModalDetalle({ visible: false })}\r\n            >\r\n                <p><strong>Evento: </strong>{ event?.name }</p>\r\n                <p><strong>Hora: </strong>{ moment(modalDetalle?.item?.createdAt?.seconds, \"X\").format(\"DD-MM-YYYY HH:mm\")}</p>\r\n                <p><strong>Forma de pago: </strong>{ modalDetalle?.item?.paymentMethod}</p>\r\n                { modalDetalle?.item?.description && <p><strong>Notas: </strong>{ modalDetalle?.item?.description }</p> }\r\n\r\n                <h3>Productos</h3>\r\n                <Table\r\n                    rowKey=\"id\"\r\n                    dataSource={(modalDetalle?.item?.items || [])}\r\n                    columns={[\r\n                        {\r\n                            title: \"Nombre\",\r\n                            dataIndex: \"name\",\r\n                            key: \"name\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"name\"),\r\n                        },\r\n                        {\r\n                            title: \"Cantidad\",\r\n                            dataIndex: \"qty\",\r\n                            key: \"qty\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"qty\"),\r\n                        },\r\n                        {\r\n                            title: \"Importe\",\r\n                            dataIndex: \"price\",\r\n                            key: \"price\",\r\n                            render: price => price + \"€\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"price\")\r\n                        }\r\n                    ]}\r\n                />\r\n\r\n                <div style={{ display: \"flex\", justifyContent: \"center\" }}>\r\n                    <Button\r\n                        type=\"primary\"\r\n                        onClick={() => setModalDetalle({ visible: false })}\r\n\r\n                    >Cerrar</Button>\r\n                </div>\r\n\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default EventStatus","import { getDoc, query, collection, addDoc, onSnapshot, doc } from 'firebase/firestore'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container, ProductBtn, PackBtn } from '../components'\r\nimport { useFirebase } from '../context/firebase'\r\nimport { useParams, useHistory, Link } from 'react-router-dom'\r\nimport { Radio, Button, Modal, Form, Select, Input, message } from 'antd'\r\nimport styled from 'styled-components'\r\nimport _ from 'lodash'\r\n\r\nconst Event = () => {\r\n\r\n    const { firestore } = useFirebase()\r\n    const { id } = useParams()\r\n    const [formEnd] = Form.useForm()\r\n    const history = useHistory()\r\n\r\n    const [products, setProducts] = useState([])\r\n    const [packs, setPacks] = useState([])\r\n    const [filteredProducts, setFilteredProducts] = useState([])\r\n    const [event, setEvent] = useState()\r\n    const [tags, setTags] = useState([])\r\n    const [selectedTag, setSelectedTag] = useState()\r\n    const [saleStatus, setSaleStatus] = useState({})\r\n    const [packItems, setPackItems] = useState([])\r\n    const [modalPackSelector, setModalPackSelector] = useState({ visible: false })\r\n    const [modalEndSale, setModalEndSale] = useState({ visible: false })\r\n    const [modalTotal, setModalTotal] = useState()\r\n    const [paymentMethod, setPaymentMethod] = useState()\r\n    const [inputMoney, setInputMoney] = useState()\r\n    const [loadingSale, setLoadingSale] = useState(false)\r\n\r\n    const filterByTag = (products, tag) => {\r\n        const filteredProducts = products\r\n            .filter(p => !tag || p.tags.includes(selectedTag))\r\n            .sort((a, b) => a.tags[0] > b.tags[1] ? 1 : -1)\r\n            .sort((a, b) => a.name > b.name ? 1 : -1)\r\n        setFilteredProducts(filteredProducts)\r\n    }\r\n\r\n    const mutateStatus = (product, delta, pack) => {\r\n        const oldQty = saleStatus[product]\r\n        let saleStatusMod = {...saleStatus}\r\n        const newQty = (oldQty || 0) + delta\r\n        if(newQty < 1){\r\n            saleStatusMod = _.omit(saleStatusMod, [product])\r\n        } else {\r\n            if(pack){\r\n                saleStatusMod = _.omit(saleStatusMod, [product])\r\n            }\r\n            else {\r\n                saleStatusMod[product] = newQty\r\n            }\r\n        }\r\n        setSaleStatus(saleStatusMod)\r\n    }\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n        const unsubscribePacks = onSnapshot(\r\n            query(collection(firestore, \"packs\")),\r\n            qs => {\r\n                const packs = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setPacks(packs)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const event = (await getDoc(doc(collection(firestore, \"events\"), id))).data()\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setEvent(event)\r\n            setTags(tags)\r\n        })()\r\n\r\n        return () => {\r\n            unsubscribeProducts()\r\n            unsubscribePacks()\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        filterByTag(products, selectedTag)\r\n    }, [products, selectedTag])\r\n\r\n    useEffect(() => {\r\n        if(modalEndSale.visible){\r\n            setModalTotal(calculateTotal())\r\n        }\r\n    }, [modalEndSale])\r\n\r\n    const calculateTotal = () => {\r\n        const reducito = Object.entries(saleStatus).reduce((acc, it) => {\r\n            const product = [...products, ...packs].find(p => p.id === it[0])\r\n            return acc + (product.price * (it[1]?.qty || it[1]))\r\n        }, 0)\r\n        return reducito\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <Link to={`/eventos/${id}`}>&lt; Volver</Link>\r\n            <h2>Nueva venta {event?.name}</h2>\r\n\r\n            <Button\r\n                onClick={() => setModalEndSale({\r\n                    visible: true\r\n                })}\r\n            >Acabar venta</Button>\r\n\r\n            <br />\r\n\r\n            <h4>Productos</h4>\r\n            <Radio.Group\r\n                onChange={evt => setSelectedTag(evt.target.value)}\r\n                value={selectedTag}\r\n                style={{ display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\" }}\r\n            >\r\n                { [...tags, \"Packs\"].map((t, i) => {\r\n                    return (\r\n                        <Radio.Button \r\n                            key={\"tag-\"+i}\r\n                            value={t}\r\n                            onClick={() => t === selectedTag && setSelectedTag(undefined)}\r\n                        >{t}</Radio.Button>\r\n                    )\r\n                })}\r\n            </Radio.Group>\r\n\r\n            <br />\r\n\r\n            { selectedTag !== \"Packs\" && (\r\n                <div>\r\n                    <ProductWrapper>\r\n                        { filteredProducts.map(fp => {\r\n                            return (\r\n                                <ProductBtn\r\n                                    key={`fp-${fp.id}`}\r\n                                    product={fp}\r\n                                    mutateStatus={mutateStatus}\r\n                                    qty={saleStatus[fp.id] || 0}\r\n                                />\r\n                            )\r\n                        })}\r\n                    </ProductWrapper>\r\n                     <br />\r\n                </div>\r\n            )}\r\n\r\n            <h4>Packs</h4>\r\n            <ProductWrapper>\r\n                { packs.map(p => {\r\n                    return (\r\n                        <ProductBtn\r\n                            key={`pack-${p.id}`}\r\n                            product={p}\r\n                            mutateStatus={mutateStatus}\r\n                            qty={saleStatus[p.id] || 0}\r\n                            modalPack={modalPackSelector}\r\n                            setModalPack={setModalPackSelector}\r\n                        />\r\n                    )\r\n                })}\r\n            </ProductWrapper>\r\n\r\n            <Modal\r\n                visible={modalPackSelector?.visible}\r\n                onCancel={() => setModalPackSelector({ visible: false })}\r\n                footer={null}\r\n            >\r\n                <ProductWrapper>\r\n                    {(products.filter(p => p.tags.includes(modalPackSelector?.pack?.tag)) || []).map(p => {\r\n                        return (\r\n                            <PackBtn\r\n                                key={`pack-${p.id}`}\r\n                                pack={modalPackSelector?.pack}\r\n                                product={p}\r\n                                packItems={packItems}\r\n                                setPackItems={setPackItems}\r\n                                qty={packItems.length || 0}\r\n                            />\r\n                        )\r\n                    })}\r\n                </ProductWrapper>\r\n                <br />\r\n                <ProductWrapper>\r\n                    <Button onClick={() => {\r\n                        setModalPackSelector({ visible: false })\r\n                        setPackItems([])\r\n                    }}>Cancelar</Button>\r\n                    <Button\r\n                        disabled={packItems.length < modalPackSelector?.pack?.units}\r\n                        type=\"primary\"\r\n                        onClick={() => {\r\n                            const newStatus = {\r\n                                ...saleStatus,\r\n                                [modalPackSelector?.pack?.id]: {\r\n                                    qty: (saleStatus[modalPackSelector?.pack?.id]?.qty || 0) + 1,\r\n                                    items: [\r\n                                        ...(modalPackSelector?.pack?.items || []),\r\n                                        ...packItems\r\n                                    ]\r\n                                }\r\n                            }\r\n                            setSaleStatus(newStatus)\r\n                            setModalPackSelector({ visible: false })\r\n                            setPackItems([])\r\n                        }}\r\n                    >Aceptar</Button>\r\n                </ProductWrapper>\r\n            </Modal>\r\n\r\n            <Modal\r\n                visible={modalEndSale?.visible}\r\n                onCancel={() => setModalEndSale({ visible: false })}\r\n                footer={null}\r\n            >\r\n                <h2>Total: { modalTotal }€</h2>\r\n\r\n                <Form\r\n                    form={formEnd}\r\n                    layout=\"vertical\"\r\n                >\r\n                    <Form.Item\r\n                        name=\"paymentMethod\"\r\n                        label=\"Forma de pago\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Select\r\n                            onChange={evt => {\r\n                                setPaymentMethod(evt)\r\n                            }}\r\n                        >\r\n                            <Select.Option value=\"Efectivo\">Efectivo</Select.Option>\r\n                            <Select.Option value=\"Bizum\">Bizum</Select.Option>\r\n                        </Select>\r\n                    </Form.Item>\r\n\r\n                    { paymentMethod === \"Efectivo\" && (\r\n                        <div>\r\n                            <Form.Item\r\n                                label=\"Me pagan...\"\r\n                            >\r\n                                <Input\r\n                                    type=\"number\"\r\n                                    onChange={evt => setInputMoney(evt.target.value)}\r\n                                    suffix=\"€\"\r\n                                ></Input>\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label=\"Devuelvo\"\r\n                            >\r\n                                <Input\r\n                                    disabled\r\n                                    type=\"number\"\r\n                                    suffix=\"€\"\r\n                                    value={inputMoney && (inputMoney - modalTotal)}\r\n                                />\r\n                            </Form.Item>\r\n                        </div>\r\n                    )}\r\n                </Form>\r\n\r\n                <br />\r\n\r\n                <BtnWrapper>\r\n                    <Button onClick={() => {\r\n                        setModalEndSale({ visible: false })\r\n                        setModalTotal()\r\n                    }}>Cancelar</Button>\r\n                    <Button\r\n                        loading={loadingSale}\r\n                        type=\"primary\"\r\n                        onClick={async () => {\r\n                            setLoadingSale(true)\r\n                            try{\r\n                                const items = Object.entries(saleStatus).map(ss => {\r\n                                    const item = [...products, ...packs].find(p => p.id === ss[0])\r\n                                    const isPack = !!(ss[1]?.items)\r\n                                    const subItems = isPack && { subItems: (ss[1].items.map(it => ({\r\n                                        id: it,\r\n                                        ref: doc(firestore, \"products\", it)\r\n                                    })))}\r\n                                    \r\n                                    return {\r\n                                        id: ss[0],\r\n                                        ref: doc(firestore, isPack ? \"packs\" : \"products\", ss[0]),\r\n                                        qty: ss[1]?.qty || ss[1],\r\n                                        price: item.price,\r\n                                        ...subItems\r\n                                    }\r\n                                })\r\n                                const sale = {\r\n                                    createdAt: new Date(),\r\n                                    paymentMethod,\r\n                                    total: calculateTotal(),\r\n                                    items\r\n                                }\r\n\r\n                                const docRef = doc(firestore, \"events\", id);\r\n                                const colRef = collection(docRef, \"sales\")\r\n                                await addDoc(colRef, sale);\r\n                                message.success(\"La venta se ha guardado correctamente\")\r\n                                history.push(`/eventos/${id}`)\r\n                            } catch(err) {\r\n                                console.log(err)\r\n                                message.error(\"Ocurrió un error durante el guardado de la venta\")\r\n                            }\r\n                            setLoadingSale(false)\r\n                        }}\r\n                    >Aceptar</Button>\r\n                </BtnWrapper>\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nconst ProductWrapper = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    justify-content: center;\r\n`\r\n\r\nconst BtnWrapper = styled.div`\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n`\r\n\r\nexport default Event","import React, { useState } from \"react\";\r\nimport { Redirect, Switch, Route } from \"react-router-dom\";\r\nimport { Home, Login, Register, Products, Events, Event, NewSale, EventStatus } from \"./pages\"\r\nimport { useAuthentication } from \"./context/authentication\";\r\n\r\nexport const App = () => {\r\n  const { isFetchingUser, isLogged } = useAuthentication();\r\n\r\n  if (!isLogged && isFetchingUser) return <h1>Cargando...</h1>;\r\n\r\n  return isLogged ? <AuthenticatedApp /> : <UnauthenticatedApp />;\r\n};\r\n\r\nconst AuthenticatedApp = () => {\r\n  const { isLogged } = useAuthentication();\r\n\r\n  if (!isLogged) return <Redirect to=\"/login\" />;\r\n\r\n  return (\r\n    <Switch>\r\n      <Route path=\"/productos\" exact><Products /></Route>\r\n      <Route path=\"/eventos\" exact><Events /></Route>\r\n      <Route path=\"/eventos/:id/nueva-venta\" exact><NewSale /></Route>\r\n      <Route path=\"/eventos/:id/resumen\" exact><EventStatus /></Route>\r\n      <Route path=\"/eventos/:id\" exact><Event /></Route>\r\n      <Route path=\"/\" exact><Home /></Route>\r\n      <Route path=\"*\">Error 404 - Page not found!</Route>\r\n    </Switch>\r\n  );\r\n};\r\n\r\nconst UnauthenticatedApp = () => {\r\n  return (\r\n    <Switch>\r\n      <Route exact path={[\"/\", \"/login\"]}>\r\n        <Login />\r\n      </Route>\r\n      <Route exact path=\"/register\">\r\n        <Register />\r\n      </Route>\r\n    </Switch>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { BrowserRouter } from \"react-router-dom\";\r\nimport { FirebaseProvider } from \"./context/firebase\";\r\nimport { AuthenticationProvider } from \"./context/authentication\";\r\n\r\ntype RootProviderProps = {\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport const RootProvider = ({ children }: RootProviderProps) => {\r\n  return (\r\n    <BrowserRouter>\r\n      <FirebaseProvider>\r\n        <AuthenticationProvider>{children}</AuthenticationProvider>\r\n      </FirebaseProvider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { App } from \"./app\";\r\nimport { RootProvider } from \"./rootProviders\";\r\nimport 'antd/dist/antd.css'\r\nimport './style.css'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <RootProvider>\r\n      <App />\r\n    </RootProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}