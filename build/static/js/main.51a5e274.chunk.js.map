{"version":3,"sources":["context/firebase.jsx","context/authentication.jsx","components/Container.jsx","components/ProductBtn.jsx","components/PackBtn.jsx","pages/Home.jsx","pages/Login.jsx","pages/Register.jsx","utils/estaSeguroDeQue.jsx","pages/Products.jsx","pages/Events.jsx","pages/Event.jsx","utils/basicSorter.jsx","pages/EventStatus.jsx","pages/Reservations.jsx","pages/NewSale.jsx","app.jsx","rootProviders.jsx","index.jsx"],"names":["firebaseConfig","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","REACT_APP_MESSAGING_SENDER_ID","appId","measurementId","firebaseApp","firebase","FirebaseContext","createContext","undefined","FirebaseProvider","children","firestore","getFirestore","auth","getAuth","useState","user","setUser","isFetchingUser","setIsFetchingUser","onAuthStateChanged","logoutUserFromFirebase","signOut","usersCollection","collection","Provider","value","createUserOnFirebase","email","password","Promise","resolve","reject","createUserWithEmailAndPassword","firebaseUser","doc","uid","set","doUserLoginOnFirebase","signInWithEmailAndPassword","useFirebase","context","useContext","Error","AuthenticationContext","AuthenticationProvider","getLoggedUser","doLogout","isLogged","doLogin","doRegister","useAuthentication","Header","styled","div","Body","Container","history","useHistory","logout","push","style","margin","padding","trigger","overlay","width","backgroundColor","color","items","label","to","key","type","onClick","MenuOutlined","Wrapper","Qty","BtnWrap","ProductBtn","product","mutateStatus","qty","modalPack","setModalPack","firstTag","_","get","reduce","acc","it","charCodeAt","toString","textShadow","fontWeight","marginBottom","name","price","disabled","size","id","MinusOutlined","visible","pack","PlusOutlined","PackBtn","packItems","setPackItems","filter","length","idx","findIndex","i","units","BtnWrapper","BigSquare","Home","Card","Login","isSubmitting","setIsSubmitting","form","Form","useForm","onSubmit","getFieldsValue","code","message","error","console","log","layout","onFinish","Item","rules","required","Password","loading","submit","Register","formValues","setFormValues","handleChange","e","target","display","flexDirection","htmlFor","onChange","estaSeguroDeQue","desea","esto","title","text","bypass","safer","field","cancelText","fn","compare","toLocaleUpperCase","Modal","confirm","className","icon","ExclamationCircleOutlined","content","evt","current","justifyContent","marginRight","destroyAll","warning","capitalize","onOk","okButtonProps","Products","mutateModal","setMutateModal","mutateModalPack","setMutateModalPack","products","setProducts","packs","setPacks","tags","setTags","selectedTags","setSelectedTags","selectedTagPack","setSelectedTagPack","setLoading","loadingPack","setLoadingPack","useEffect","unsubscribeProducts","onSnapshot","query","qs","docs","map","data","unsubscribePacks","getDoc","config","formPack","createProduct","addDoc","parseFloat","success","updateProduct","setDoc","deleteProduct","deleteDoc","createPack","tag","updatePack","deletePack","columns","dataIndex","render","setFieldsValue","edit","EditOutlined","DeleteOutlined","columnsPack","onCancel","dataSource","rowKey","footer","uniq","getFieldValue","Option","t","resetFields","Events","events","setEvents","unsubscribeEvents","createEvent","date","toDate","updateEvent","moment","Event","useParams","event","setEvent","basicSorter","a","b","EventStatus","sales","setSales","total","setTotal","modalDetalle","setModalDetalle","unsubscribeSales","eventRaw","ref","seconds","format","sorter","createdAt","subItems","flat","item","populatedItem","find","p","EyeOutlined","paymentMethod","description","Reservations","reservations","setReservations","showCompleted","setShowCompleted","filteredReservations","setFilteredReservations","pendingProducts","setPendingProducts","detailModal","setDetailModal","deliverModal","setDeliverModal","unsubscribeReservations","Object","values","groupBy","r","totalQty","delivered","completed","deleteReservation","reservationMethod","address","aDate","bDate","res","prod","parseInt","ExportOutlined","productColumns","aName","bName","relatedProduct","deliverProducts","reservation","deliveredProducts","complete","itemsMod","updateDoc","Array","isArray","every","dp","some","thisTimeDelivered","overflowX","observations","n","deliverQtys","dq","ProductWrapper","formEnd","filteredProducts","setFilteredProducts","selectedTag","setSelectedTag","saleStatus","setSaleStatus","modalPackSelector","setModalPackSelector","modalEndSale","setModalEndSale","modalTotal","setModalTotal","setPaymentMethod","setReservationMethod","inputMoney","setInputMoney","loadingSale","setLoadingSale","isReservation","setReservation","delta","oldQty","saleStatusMod","newQty","omit","location","pathname","includes","sort","filterByTag","calculateTotal","entries","Group","flexWrap","Button","fp","newStatus","TextArea","suffix","dataForm","ss","isPack","sale","Date","docRef","colRef","App","AuthenticatedApp","path","exact","NewSale","UnauthenticatedApp","RootProvider","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.51a5e274.chunk.js","sourcesContent":["import React, { createContext, useContext, useState } from \"react\";\r\nimport * as firebase from \"firebase/app\";\r\nimport { getFirestore, collection } from 'firebase/firestore'\r\nimport { \r\n  getAuth, \r\n  onAuthStateChanged, \r\n  createUserWithEmailAndPassword, \r\n  signInWithEmailAndPassword \r\n} from 'firebase/auth'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_API_KEY,\r\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\r\n  // databaseURL: process.env.REACT_APP_DATABASE_URL,\r\n  projectId: process.env.REACT_APP_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_APP_ID,\r\n  measurementId: process.env.REACT_APP_MEASUREMENT_ID,\r\n};\r\n\r\nconst firebaseApp = firebase.initializeApp(firebaseConfig);\r\n\r\nconst FirebaseContext = createContext(undefined);\r\n\r\nfunction FirebaseProvider({ children }) {\r\n\r\n  const firestore = getFirestore(firebaseApp);\r\n  const auth = getAuth(firebaseApp);\r\n\r\n  // AUTHENTICATION\r\n  const [user, setUser] = useState(null);\r\n  const [isFetchingUser, setIsFetchingUser] = useState(true);\r\n\r\n  onAuthStateChanged(auth, (user) => {\r\n    if (user) {\r\n      setUser(user);\r\n    } else {\r\n      setUser(null);\r\n    }\r\n\r\n    setIsFetchingUser(false);\r\n  });\r\n\r\n  const createUserOnFirebase = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        const firebaseUser = await createUserWithEmailAndPassword(\r\n          auth,\r\n          email,\r\n          password\r\n        );\r\n\r\n        if (!firebaseUser.user) {\r\n          reject();\r\n          return;\r\n        }\r\n\r\n        await usersCollection.doc(firebaseUser.user.uid).set({\r\n          email: firebaseUser.user.email,\r\n        });\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const doUserLoginOnFirebase = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        await signInWithEmailAndPassword(auth, email, password);\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const logoutUserFromFirebase = async () => await auth.signOut();\r\n\r\n  // FIRESTORE\r\n  const usersCollection = collection(firestore, \"users\");\r\n\r\n  return (\r\n    <FirebaseContext.Provider\r\n      value={{\r\n        createUserOnFirebase,\r\n        doUserLoginOnFirebase,\r\n        logoutUserFromFirebase,\r\n        user,\r\n        firestore,\r\n        isFetchingUser,\r\n      }}\r\n    >\r\n      {children}\r\n    </FirebaseContext.Provider>\r\n  );\r\n}\r\n\r\nfunction useFirebase() {\r\n  const context = useContext(FirebaseContext);\r\n\r\n  if (context === undefined) {\r\n    throw new Error(\"useFirebase must be used within a FirebaseProvider\");\r\n  }\r\n\r\n  return context;\r\n}\r\n\r\nexport { FirebaseProvider, useFirebase };\r\n","import React, { createContext, ReactNode, useContext } from \"react\";\r\nimport { useFirebase } from \"./firebase\";\r\n\r\n\r\nconst AuthenticationContext = createContext(undefined);\r\n\r\nconst AuthenticationProvider = ({ children }) => {\r\n  const {\r\n    createUserOnFirebase,\r\n    doUserLoginOnFirebase,\r\n    logoutUserFromFirebase,\r\n    user,\r\n    isFetchingUser,\r\n  } = useFirebase();\r\n\r\n  const getLoggedUser = () => user;\r\n\r\n  const doLogin = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        await doUserLoginOnFirebase(email, password);\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const doRegister = (email, password) =>\r\n    new Promise(async (resolve, reject) => {\r\n      try {\r\n        await createUserOnFirebase(email, password);\r\n\r\n        resolve();\r\n      } catch (e) {\r\n        reject(e);\r\n      }\r\n    });\r\n\r\n  const doLogout = async () => await logoutUserFromFirebase();\r\n\r\n  return (\r\n    <AuthenticationContext.Provider\r\n      value={{\r\n        isLogged: !!getLoggedUser(),\r\n        user: getLoggedUser(),\r\n        isFetchingUser,\r\n        doLogin,\r\n        doRegister,\r\n        doLogout,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthenticationContext.Provider>\r\n  );\r\n};\r\n\r\nconst useAuthentication = () => {\r\n  const context = useContext(AuthenticationContext);\r\n\r\n  if (context === undefined) {\r\n    throw new Error(\r\n      \"useAuthentication must be used within a AuthenticationProvider\"\r\n    );\r\n  }\r\n\r\n  return context;\r\n};\r\n\r\nexport { AuthenticationProvider, useAuthentication };\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button, Dropdown, Menu } from 'antd'\r\nimport { Link } from 'react-router-dom'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { useAuthentication } from '../context/authentication'\r\nimport { MenuOutlined } from '@ant-design/icons'\r\n\r\nconst Container = ({ children }) => {\r\n    const history = useHistory()\r\n    const { doLogout, user } = useAuthentication()\r\n\r\n    const logout = async () => {\r\n      await doLogout();\r\n      history.push(\"/login\");\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Header>\r\n                <h3 style={{ margin: 0, padding: 0 }}>La buena feria</h3>\r\n                {/* <div>\r\n                    <Link to=\"/productos\"><Button>Productos</Button></Link>\r\n                    <Link to=\"/eventos\"><Button>Eventos</Button></Link>\r\n                    <Link to=\"/reservas\"><Button>Reservas</Button></Link>\r\n                </div> */}\r\n                <Dropdown\r\n                    trigger={['click']}\r\n                    overlay={\r\n                        <div>\r\n                            <div style={{ width: \"100%\", padding: 4, backgroundColor: \"#fafafa\" }}>\r\n                                <small style={{ color: \"gray\" }}>Estás logueado como {user.email}</small>\r\n                            </div>\r\n                            <Menu\r\n                                items={[\r\n                                    {\r\n                                        label: <Link to=\"/\">Inicio</Link>,\r\n                                        key: '-1',\r\n                                    },\r\n                                    {\r\n                                        label: <Link to=\"/productos\">Productos</Link>,\r\n                                        key: '0',\r\n                                    },\r\n                                    {\r\n                                        label: <Link to=\"/eventos\">Eventos</Link>,\r\n                                        key: '1',\r\n                                    },\r\n                                    {\r\n                                        label: <Link to=\"/reservas\">Reservas</Link>,\r\n                                        key: '2',\r\n                                    },\r\n                                    {\r\n                                        type: 'divider',\r\n                                    },\r\n                                    {\r\n                                        label: <span onClick={() => logout()}>Cerrar sesión</span>,\r\n                                        key: '3',\r\n                                    },\r\n                                ]}\r\n                            />\r\n                        </div>\r\n                    }\r\n                >\r\n                    <Button><MenuOutlined /></Button>\r\n                </Dropdown>\r\n            </Header>\r\n            <Body>\r\n                { children }\r\n            </Body>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst Header = styled.div`\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background-color: #d7ffea;\r\n    height: 40px;\r\n    border-bottom: 1px solid gainsboro;\r\n    box-shadow: 0px 2px 4px 1px rgba(0, 0, 0, 0.1);\r\n    padding: 0 1em;\r\n`\r\nconst Body = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    margin: 1em;\r\n    width: calc(100% - 2em);\r\n`\r\n\r\nexport default Container","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button, Tag } from 'antd'\r\nimport { MinusOutlined, PlusOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash'\r\n\r\nconst ProductBtn = ({ product, mutateStatus, qty, modalPack, setModalPack }) => {\r\n    const firstTag = _.get(product, \"tags[0]\", \"\") \r\n    const color = firstTag ? ([...firstTag].reduce((acc, it) => acc * it.charCodeAt(), 123123) % 16777215).toString(16) : \"FFFFFF\"\r\n    return (\r\n        <Wrapper color={\"#\" + color}>\r\n            <Qty>\r\n                {!!qty && <Tag>{ qty?.qty || qty }</Tag>}\r\n            </Qty>\r\n\r\n            <p style={{\r\n                textShadow: \"0px 0px 8px white\",\r\n                fontWeight: \"bold\",\r\n                marginBottom: \"6px\"\r\n            }}>{ product.name }</p>\r\n            {(qty?.qty || qty) > 0 && <strong>{(qty?.qty || qty) * product.price }€</strong> }\r\n\r\n            <BtnWrap>\r\n                <Button \r\n                    disabled={qty < 1}\r\n                    size='small' \r\n                    onClick={() => mutateStatus(product.id, -1, !!modalPack)}\r\n                >\r\n                    <MinusOutlined />\r\n                </Button>\r\n                <Button \r\n                    size='small' \r\n                    onClick={() => {\r\n                        if(modalPack){\r\n                            setModalPack({\r\n                                visible: true,\r\n                                pack: product\r\n                            })\r\n                        } else {\r\n                            mutateStatus(product.id, 1)\r\n                        }\r\n                    }}\r\n                >\r\n                    <PlusOutlined />\r\n                </Button>\r\n            </BtnWrap>\r\n        </Wrapper>\r\n    )\r\n}\r\n\r\nconst Wrapper = styled.div`\r\n    width: 105px;\r\n    height: 140px;\r\n    border-radius: 4px;\r\n    border: 1px solid gainsboro;\r\n    margin: 4px;\r\n    position: relative;\r\n    padding: 1em;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    background-color: ${({ color }) => color};\r\n\r\n`\r\n\r\nconst Qty = styled.div`\r\n    position: absolute;\r\n    top: -6px;\r\n    right: -14px;\r\n`\r\n\r\nconst BtnWrap = styled.div`\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n`\r\n\r\nexport default ProductBtn","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { Button, Tag } from 'antd'\r\nimport { MinusOutlined, PlusOutlined } from '@ant-design/icons'\r\n\r\nconst PackBtn = ({ product, pack, packItems, setPackItems }) => {\r\n    const qty = packItems.filter(it => it === product?.id)?.length\r\n\r\n    return (\r\n        <Wrapper>\r\n            <Qty><Tag>{ qty }</Tag></Qty>\r\n\r\n            { product.name }\r\n\r\n            <BtnWrap>\r\n                <Button \r\n                    disabled={packItems?.length < 0}\r\n                    size='small' \r\n                    onClick={() => {\r\n                        const idx = packItems.findIndex(it => it === product.id)\r\n                        setPackItems(packItems.filter((it, i) => i !== idx))\r\n                    }}\r\n                >\r\n                    <MinusOutlined />\r\n                </Button>\r\n                <Button \r\n                    disabled={packItems?.length >= pack?.units}\r\n                    size='small' \r\n                    onClick={() => {\r\n                        setPackItems([\r\n                            ...packItems,\r\n                            product.id\r\n                        ])\r\n                    }}\r\n                >\r\n                    <PlusOutlined />\r\n                </Button>\r\n            </BtnWrap>\r\n        </Wrapper>\r\n    )\r\n}\r\n\r\nconst Wrapper = styled.div`\r\n    width: 110px;\r\n    height: 110px;\r\n    border-radius: 4px;\r\n    border: 1px solid gainsboro;\r\n    margin: 4px;\r\n    position: relative;\r\n    padding: 1em;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n\r\n`\r\n\r\nconst Qty = styled.div`\r\n    position: absolute;\r\n    top: -6px;\r\n    right: -14px;\r\n`\r\n\r\nconst BtnWrap = styled.div`\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n`\r\n\r\nexport default PackBtn","import React from \"react\";\r\nimport { useAuthentication } from \"../context/authentication\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Container } from \"../components\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Home = () => {\r\n  const { user } = useAuthentication();\r\n\r\n  return (\r\n    <Container>\r\n      <h3>Ale {user?.email}, a vender mucho :)</h3>\r\n      <BtnWrapper>\r\n          <Link to=\"/eventos\"><BigSquare>Eventos</BigSquare></Link>\r\n          <Link to=\"/reservas\"><BigSquare>Reservas</BigSquare></Link>\r\n          <Link to=\"/productos\"><BigSquare>Productos</BigSquare></Link>\r\n      </BtnWrapper>\r\n    </Container>\r\n  );\r\n};\r\n\r\nconst BtnWrapper = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 1em;\r\n`\r\n\r\nconst BigSquare = styled.div`\r\n  height: 125px;\r\n  width: 125px;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  text-align: center;\r\n  border: 1px solid gainsboro;\r\n  border-radius: 4px;\r\n  box-shadow: 0 0 6px 1px rgba(0, 0, 0, 0.05);\r\n  margin: 0.5em;\r\n  color: #232323;\r\n  font-size: 1.6em;\r\n`\r\n\r\nexport default Home\r\n","import { Button, Form, Input, message } from \"antd\";\r\nimport React, { useState } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\nimport { useAuthentication } from \"../context/authentication\";\r\n\r\nconst Login = () => {\r\n  const history = useHistory();\r\n  const { doLogin } = useAuthentication();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const form = Form.useForm()[0]\r\n\r\n  const onSubmit = async () => {\r\n    const { email, password } = form.getFieldsValue()\r\n    try {\r\n      await doLogin(email, password);\r\n      history.push(\"/\");\r\n    } catch (err) {\r\n      if(err.code === \"auth/wrong-password\" || err.code === \"auth/user-not-found\"){\r\n        message.error(\"Usuario o contraseña incorrectos\")\r\n      } else {\r\n        message.error(\"Ocurrió un problema en el proceso de login\")\r\n        console.log(err)\r\n      }\r\n    }\r\n    setIsSubmitting(false);\r\n  };\r\n\r\n  return (\r\n    <Wrapper>\r\n      <Card>\r\n        <Form\r\n          layout=\"vertical\"\r\n          form={form}\r\n          onFinish={() => onSubmit()}\r\n        >\r\n          <Form.Item\r\n            type=\"email\"\r\n            rules={[{ required: true, message: \"Campo requerido\" }]}\r\n            label=\"Email\"\r\n            name=\"email\"\r\n          >\r\n            <Input />\r\n          </Form.Item>\r\n          <Form.Item\r\n            type=\"password\"\r\n            rules={[{ required: true, message: \"Campo requerido\" }]}\r\n            label=\"Contraseña\"\r\n            name=\"password\"\r\n          >\r\n            <Input.Password />\r\n          </Form.Item>\r\n          <Button \r\n            type=\"primary\"\r\n            disabled={isSubmitting} \r\n            loading={isSubmitting}\r\n            onClick={() => form.submit()}\r\n          >\r\n            Acceder\r\n          </Button>\r\n        </Form>\r\n      </Card>\r\n    </Wrapper>\r\n  );\r\n};\r\n\r\nconst Wrapper = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  width: 100%;\r\n  height: 100vh;\r\n  background-color: gainsboro;\r\n`\r\n\r\nconst Card = styled.div`\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  padding: 1em;\r\n  border-radius: 4px;\r\n  background-color: white;\r\n  box-shadow: 0px 0px 6px 1px rgba(0, 0, 0, 0.1);\r\n`\r\n\r\nexport default Login\r\n","import React, { useState } from \"react\";\r\nimport { useHistory, Link } from \"react-router-dom\";\r\nimport { useAuthentication } from \"../context/authentication\";\r\n\r\nconst Register = () => {\r\n  const { push } = useHistory();\r\n  const { doRegister } = useAuthentication();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [formValues, setFormValues] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n  });\r\n\r\n  const onSubmit = async () => {\r\n    const { email, password } = formValues;\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n\r\n      await doRegister(email, password);\r\n\r\n      push(\"/\");\r\n    } catch (e) {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleChange = e => {\r\n    setFormValues({\r\n      ...formValues,\r\n      [e.target.name]: e.target.value,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <form>\r\n      <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n        <div>\r\n          <label htmlFor=\"email\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            required\r\n            id=\"email\"\r\n            name=\"email\"\r\n            value={formValues.email}\r\n            onChange={handleChange}\r\n          />\r\n        </div>\r\n        <div>\r\n          <label htmlFor=\"password\">Password</label>\r\n          <input\r\n            type=\"password\"\r\n            required\r\n            id=\"password\"\r\n            name=\"password\"\r\n            value={formValues.password}\r\n            onChange={handleChange}\r\n          />\r\n        </div>\r\n        <div\r\n          style={{\r\n            display: \"flex\",\r\n            flexDirection: \"column\",\r\n            width: \"fit-content\",\r\n          }}\r\n        >\r\n          <button disabled={isSubmitting} onClick={onSubmit}>\r\n            {isSubmitting ? \"registering...\" : \"register\"}\r\n          </button>\r\n          <Link to=\"/login\">I already have an account</Link>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default Register\r\n","import React from 'react'\r\nimport { Input, Modal, Form, Button, message } from 'antd'\r\nimport { capitalize } from 'lodash'\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons'\r\n\r\n//Enola Gay, is mother proud of little boy today? \r\nconst estaSeguroDeQue = ({ desea, esto, title, text, bypass, loading, safer, field, cancelText, fn }) => {\r\n\r\n    const compare = safer ? (desea + \" \" + esto).toLocaleUpperCase() : \"\"\r\n\r\n    if(!bypass){\r\n        Modal.confirm({\r\n            className: \"customConfirm\",\r\n            icon: <ExclamationCircleOutlined color=\"#FFAB24\" />,\r\n            title: title ? title : `¿Está seguro de que desea ${desea} ${esto}?`,\r\n            content: <div>\r\n                <p>{text}</p>\r\n                { safer && <>\r\n                    <br />\r\n                    <p>Si quieres continuar, escribe \"{compare}\" en el campo que tienes a continuación</p>\r\n                    <Form.Item>\r\n                        <Input onChange={evt => field.current = evt.target.value}/>\r\n                    </Form.Item>\r\n                </>}\r\n                <br />\r\n                <div style={{ display: \"flex\", justifyContent: \"flex-end\"}}>\r\n                    <Button style={{ marginRight: \"1em\" }} onClick={() => Modal.destroyAll()}>{cancelText || \"Cancelar\"}</Button>\r\n                    <Button type=\"primary\" onClick={() => {\r\n                        if(safer){\r\n                            if(!field){\r\n                                throw new Error(\"Para usar la opción safer hay que pasar un ref de tipo string en el prop field `const fieldRef = useRef<string>(\\\"\\\")`\")\r\n                            }\r\n                            if(compare === (field.current || \"\").toLocaleUpperCase()){\r\n                                fn()\r\n                                field.current = \"\"\r\n                                Modal.destroyAll()\r\n                            } else {\r\n                                message.warning(\"Introduzca el texto de confirmación\")\r\n                            }\r\n                        } else {\r\n                            fn()\r\n                            Modal.destroyAll()\r\n                        }\r\n                    }}>{ capitalize(desea) || \"Aceptar\" }</Button>\r\n                </div>\r\n            </div>,\r\n            onOk: () => {},\r\n            okButtonProps: { loading }\r\n        })\r\n    } else {\r\n        fn()\r\n    }\r\n}\r\n\r\nexport default estaSeguroDeQue","import { Button, Modal, Input, Table, Tag, Form, Select, message } from 'antd'\r\nimport { collection, query, doc, getDocs, getDoc, addDoc, setDoc, deleteDoc, onSnapshot } from \"firebase/firestore\";\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase';\r\nimport { DeleteOutlined, EditOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash';\r\nimport estaSeguroDeQue from '../utils/estaSeguroDeQue';\r\n\r\nconst Products = () => {\r\n    const { firestore } = useFirebase()\r\n\r\n    const [mutateModal, setMutateModal] = useState({ visible: false })\r\n    const [mutateModalPack, setMutateModalPack] = useState({ visible: false })\r\n    const [products, setProducts] = useState([])\r\n    const [packs, setPacks] = useState([])\r\n    const [tags, setTags] = useState([])\r\n    const [selectedTags, setSelectedTags] = useState([])\r\n    const [selectedTagPack, setSelectedTagPack] = useState()\r\n    const [loading, setLoading] = useState(false)\r\n    const [loadingPack, setLoadingPack] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n        const unsubscribePacks = onSnapshot(\r\n            query(collection(firestore, \"packs\")),\r\n            qs => {\r\n                const packs = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setPacks(packs)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setTags(tags)\r\n        })()\r\n        \r\n        return () => {\r\n            unsubscribeProducts()\r\n            unsubscribePacks()\r\n        }\r\n    }, [])\r\n\r\n    const [form] = Form.useForm()\r\n    const [formPack] = Form.useForm()\r\n\r\n    const createProduct = async () => {\r\n        try{\r\n            setLoading(true)\r\n            // const { name, tags, price1, price2 } = form.getFieldsValue(true)\r\n            const { name, tags, price } = form.getFieldsValue(true)\r\n            const added = await addDoc(collection(firestore, \"products\"), {\r\n                name,\r\n                tags,\r\n                price: parseFloat(price)\r\n                // price: [price1, price2].filter(e => e)\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El producto se ha creado correctamente\")\r\n            setLoading(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la creación del producto\")\r\n        }\r\n    }\r\n    const updateProduct = async id => {\r\n        try{\r\n            setLoading(true)\r\n            const { name, tags, price } = form.getFieldsValue(true)\r\n            const updated = await setDoc(doc(firestore, \"products\", id), {\r\n                name,\r\n                tags,\r\n                price: parseFloat(price)\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El producto se ha editado correctamente\")\r\n            setLoading(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la edición del producto\")\r\n        }\r\n    }\r\n    const deleteProduct = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"products\", id))\r\n            message.success(\"El producto se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado del producto\")\r\n        }\r\n    }\r\n\r\n    const createPack = async () => {\r\n        try{\r\n            setLoadingPack(true)\r\n            // const { name, tags, price1, price2 } = form.getFieldsValue(true)\r\n            const { name, tag, price, units } = formPack.getFieldsValue(true)\r\n            const added = await addDoc(collection(firestore, \"packs\"), {\r\n                name,\r\n                tag,\r\n                price: parseFloat(price),\r\n                units\r\n                // price: [price1, price2].filter(e => e)\r\n            })\r\n            setMutateModalPack({ visible: false })\r\n            message.success(\"El pack se ha creado correctamente\")\r\n            setLoadingPack(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la creación del pack\")\r\n        }\r\n    }\r\n    const updatePack = async id => {\r\n        try{\r\n            setLoadingPack(true)\r\n            const { name, tag, price, units } = formPack.getFieldsValue(true)\r\n            const updated = await setDoc(doc(firestore, \"packs\", id), {\r\n                name,\r\n                tag,\r\n                price: parseFloat(price),\r\n                units\r\n            })\r\n            setMutateModalPack({ visible: false })\r\n            message.success(\"El pack se ha editado correctamente\")\r\n            setLoadingPack(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la edición del pack\")\r\n        }\r\n    }\r\n    const deletePack = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"packs\", id))\r\n            message.success(\"El pack se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado del pack\")\r\n        }\r\n    }\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\"\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: it => {\r\n                return (\r\n                    <div>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                form.setFieldsValue({\r\n                                    name: it.name,\r\n                                    price: it.price,\r\n                                    tags: it.tags\r\n                                })\r\n                                setSelectedTags(it.tags)\r\n                                setMutateModal({\r\n                                    visible: true,\r\n                                    edit: true,\r\n                                    id: it.id\r\n                                })\r\n                            }}\r\n                        ><EditOutlined /></Tag>\r\n                        &nbsp;\r\n                        <Tag \r\n                            color=\"volcano\"\r\n                            onClick={() => {\r\n                                estaSeguroDeQue({\r\n                                    desea: \"eliminar\",\r\n                                    esto: it.name,\r\n                                    loading,\r\n                                    fn: async () => {\r\n                                        setLoading(true)\r\n                                        await deleteProduct(it.id)\r\n                                        setLoading(false)\r\n                                    }\r\n                                })\r\n                            }}\r\n                        ><DeleteOutlined /></Tag>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n\r\n    const columnsPack = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\"\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: it => {\r\n                return (\r\n                    <div>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                formPack.setFieldsValue({\r\n                                    name: it.name,\r\n                                    price: it.price,\r\n                                    tag: it.tag,\r\n                                    units: it.units\r\n                                })\r\n                                setSelectedTagPack(it.tag)\r\n                                setMutateModalPack({\r\n                                    visible: true,\r\n                                    edit: true,\r\n                                    id: it.id\r\n                                })\r\n                            }}\r\n                        ><EditOutlined /></Tag>\r\n                        &nbsp;\r\n                        <Tag \r\n                            color=\"volcano\"\r\n                            onClick={() => {\r\n                                estaSeguroDeQue({\r\n                                    desea: \"eliminar\",\r\n                                    esto: it.name,\r\n                                    loading,\r\n                                    fn: async () => {\r\n                                        setLoadingPack(true)\r\n                                        await deletePack(it.id)\r\n                                        setLoadingPack(false)\r\n                                    }\r\n                                })\r\n                            }}\r\n                        ><DeleteOutlined /></Tag>\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n    return (\r\n        <Container>\r\n            <h2>Productos</h2>\r\n            <Button \r\n                onClick={() => setMutateModal({ visible: true, edit: false })}\r\n                onCancel={() => setMutateModal({ visible: false })}\r\n                style={{ marginBottom: \"1em\" }}\r\n            >Crear producto</Button>\r\n\r\n            <div style={{ width: \"100%\" }}>\r\n                <Table\r\n                    dataSource={products}\r\n                    rowKey=\"id\"\r\n                    columns={columns}\r\n                />\r\n            </div>\r\n\r\n            <h2>Packs</h2>\r\n            <Button \r\n                onClick={() => setMutateModalPack({ visible: true, edit: false })}\r\n                onCancel={() => setMutateModalPack({ visible: false })}\r\n                style={{ marginBottom: \"1em\" }}\r\n            >Crear pack</Button>\r\n\r\n            <div style={{ width: \"100%\" }}>\r\n                <Table\r\n                    dataSource={packs}\r\n                    rowKey=\"id\"\r\n                    columns={columnsPack}\r\n                />\r\n            </div>\r\n\r\n            <Modal \r\n                visible={mutateModal.visible}\r\n                onCancel={() => setMutateModal({ visible: false })}\r\n                onOk={() => mutateModal?.edit ? updateProduct(mutateModal?.id) : createProduct()}\r\n                footer={null}\r\n            >\r\n                <h3>{mutateModal?.edit ? \"Editar producto\" : \"Nuevo producto\"}</h3>\r\n                <Form\r\n                    form={form}\r\n                    layout=\"vertical\"\r\n                    onFinish={() => mutateModal?.edit ? updateProduct(mutateModal?.id) : createProduct()}\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"price\"\r\n                        label=\"Precio\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input type=\"number\"/>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        label=\"Etiquetas\"\r\n                    >\r\n                        <Select\r\n                            onChange={it => {\r\n                                const tags = _.uniq([\r\n                                    ...(form.getFieldValue(\"tags\") || []),\r\n                                    it\r\n                                ])\r\n                                form.setFieldsValue({ tags })\r\n                                setSelectedTags(tags)\r\n                            }}\r\n                        >\r\n                            { tags.map((tag, i) => {\r\n                                return (\r\n                                    <Select.Option value={tag} key={\"tag-option\" + i}>{ tag }</Select.Option>\r\n                                )\r\n                            })}\r\n                        </Select>\r\n                        {(selectedTags || []).map((tag, i) => {\r\n                            return (\r\n                                <Tag key={\"tag\"+i} onClick={() => {\r\n                                    const tags = form.getFieldValue(\"tags\").filter(t => t !== tag)\r\n                                    form.setFieldsValue({ tags })\r\n                                    setSelectedTags(tags)\r\n                                }}>{tag} &times;</Tag>\r\n                            )\r\n                        })}\r\n                    </Form.Item>\r\n                </Form>\r\n                <div>\r\n                    <Button \r\n                        type=\"primary\" \r\n                        loading={loading} \r\n                        onClick={() => form.submit()}\r\n                    >{ mutateModal?.edit ? \"Editar\" : \"Crear\" }</Button>\r\n                    &nbsp;&nbsp;\r\n                    <Button onClick={() => {\r\n                        form.resetFields()\r\n                        setLoading(false)\r\n                        setMutateModal({ visible: false })\r\n                    }}>Cancelar</Button>\r\n                </div>\r\n            </Modal>\r\n\r\n            \r\n            <Modal \r\n                visible={mutateModalPack.visible}\r\n                onCancel={() => setMutateModalPack({ visible: false })}\r\n                onOk={() => mutateModalPack?.edit ? updatePack(mutateModalPack?.id) : createPack()}\r\n                footer={null}\r\n            >\r\n                <h3>{mutateModalPack?.edit ? \"Editar pack\" : \"Nuevo pack\"}</h3>\r\n                <Form\r\n                    form={formPack}\r\n                    layout=\"vertical\"\r\n                    onFinish={() => mutateModalPack?.edit ? updatePack(mutateModalPack?.id) : createPack()}\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre del pack\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"price\"\r\n                        label=\"Precio\"\r\n                        type=\"number\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input type=\"number\"/>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"units\"\r\n                        label=\"Unidades\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input type=\"number\"/>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        label=\"Etiqueta\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Select \r\n                            onChange={tag => {\r\n                                setSelectedTagPack(tag)\r\n                                formPack.setFieldsValue({ tag })\r\n                            }}\r\n                            value={selectedTagPack}\r\n                        >\r\n\r\n                            { tags.map((tag, i) => {\r\n                                return (\r\n                                    <Select.Option value={tag} key={\"tag-option\" + i}>{ tag }</Select.Option>\r\n                                )\r\n                            })}\r\n                        </Select>\r\n                    </Form.Item>\r\n                </Form>\r\n                <div>\r\n                    <Button \r\n                        type=\"primary\" \r\n                        loading={loadingPack} \r\n                        onClick={() => formPack.submit()}\r\n                    >{ mutateModalPack?.edit ? \"Editar\" : \"Crear\" }</Button>\r\n                    &nbsp;&nbsp;\r\n                    <Button onClick={() => {\r\n                        formPack.resetFields()\r\n                        setLoadingPack(false)\r\n                        setMutateModalPack({ visible: false })\r\n                    }}>Cancelar</Button>\r\n                </div>\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Products","import { Button, Modal, Input, Table, Tag, Form, Select, message, DatePicker, Switch } from 'antd'\r\nimport { collection, query, doc, getDocs, getDoc, addDoc, setDoc, deleteDoc, onSnapshot } from \"firebase/firestore\";\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase';\r\nimport { DeleteOutlined, EditOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash';\r\nimport estaSeguroDeQue from '../utils/estaSeguroDeQue';\r\nimport { useHistory, Link } from 'react-router-dom';\r\nimport moment from 'moment'\r\n\r\nconst Events = () => {\r\n    const { firestore } = useFirebase()\r\n    const history = useHistory()\r\n\r\n    const [mutateModal, setMutateModal] = useState({ visible: false })\r\n    const [events, setEvents] = useState([])\r\n    const [loading, setLoading] = useState(false)\r\n\r\n    useEffect(() => {\r\n        const unsubscribeEvents = onSnapshot(\r\n            query(collection(firestore, \"events\")),\r\n            qs => {\r\n                const events = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setEvents(events)\r\n            }\r\n        )\r\n        return () => unsubscribeEvents()\r\n    }, [])\r\n\r\n    const [form] = Form.useForm()\r\n\r\n    const createEvent = async () => {\r\n        try{\r\n            setLoading(true)\r\n            const { name, date } = form.getFieldsValue(true)\r\n            const added = await addDoc(collection(firestore, \"events\"), {\r\n                name,\r\n                date: date.toDate()\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El evento se ha creado correctamente\")\r\n            setLoading(false)\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la creación del evento\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n    const updateEvent = async id => {\r\n        try{\r\n            setLoading(true)\r\n            const { name, date } = form.getFieldsValue(true)\r\n            const updated = await setDoc(doc(firestore, \"events\", id), {\r\n                name,\r\n                date: date.toDate()\r\n            })\r\n            setMutateModal({ visible: false })\r\n            message.success(\"El evento se ha editado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante la edición del evento\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n    const deleteEvent = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"events\", id))\r\n            message.success(\"El evento se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado del evento\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\"\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: it => {\r\n                return (\r\n                    <div>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                console.log(it)\r\n                                form.setFieldsValue({\r\n                                    name: it.name,\r\n                                    date: moment(it.date.toDate())\r\n                                })\r\n                                setMutateModal({\r\n                                    visible: true,\r\n                                    edit: true,\r\n                                    id: it.id\r\n                                })\r\n                            }}\r\n                        ><EditOutlined /></Tag>\r\n                        {/* &nbsp;\r\n                        <Tag \r\n                            color=\"volcano\"\r\n                            onClick={() => {\r\n                                estaSeguroDeQue({\r\n                                    desea: \"eliminar\",\r\n                                    esto: it.name,\r\n                                    loading,\r\n                                    fn: async () => {\r\n                                        setLoading(true)\r\n                                        await deleteEvent(it.id)\r\n                                        setLoading(false)\r\n                                    }\r\n                                })\r\n                            }}\r\n                        ><DeleteOutlined /></Tag> */}\r\n                    </div>\r\n                )\r\n            }\r\n        },\r\n        {  \r\n            title: \"\",\r\n            render: evt => {\r\n                return (\r\n                    <Link to={`/eventos/${evt.id}`}>\r\n                        <Button \r\n                            type=\"primary\"\r\n                        >Entrar</Button>\r\n                    </Link>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n    return (\r\n        <Container>\r\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", width: \"100%\" }}>\r\n                <h2>Eventos</h2>\r\n                <Button\r\n                    onClick={() => setMutateModal({ visible: true, edit: false })}\r\n                    onCancel={() => setMutateModal({ visible: false })}\r\n                >Crear evento</Button>\r\n            </div>\r\n\r\n            <div\r\n                style={{ width: \"100%\" }}\r\n            >\r\n                <Table\r\n                    dataSource={events}\r\n                    rowKey=\"id\"\r\n                    columns={columns}\r\n                />\r\n            </div>\r\n            <Modal \r\n                visible={mutateModal.visible}\r\n                onCancel={() => setMutateModal({ visible: false })}\r\n                onOk={() => mutateModal?.edit ? updateEvent(mutateModal?.id) : createEvent()}\r\n                footer={null}\r\n            >\r\n                <h3>{mutateModal?.edit ? \"Editar evento\" : \"Nuevo evento\"}</h3>\r\n                <Form\r\n                    form={form}\r\n                    layout=\"vertical\"\r\n                    onFinish={() => mutateModal?.edit ? updateEvent(mutateModal?.id) : createEvent()}\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                        name=\"date\"\r\n                        label=\"Fecha\"\r\n                        rules={[{ required: true }]}\r\n                    >\r\n                        <DatePicker />\r\n                    </Form.Item>\r\n                </Form>\r\n                <div>\r\n                    <Button \r\n                        type=\"primary\" \r\n                        loading={loading} \r\n                        onClick={() => form.submit()}\r\n                    >{ mutateModal?.edit ? \"Editar\" : \"Crear\" }</Button>\r\n                    &nbsp;&nbsp;\r\n                    <Button onClick={() => {\r\n                        form.resetFields()\r\n                        setLoading(false)\r\n                        setMutateModal({ visible: false })\r\n                    }}>Cancelar</Button>\r\n                </div>\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Events","import { getDoc, query, collection, getDocs, onSnapshot, doc } from 'firebase/firestore'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase'\r\nimport { Button } from 'antd'\r\nimport { useParams, Link } from 'react-router-dom'\r\nimport styled from 'styled-components'\r\n\r\nconst Event = () => {\r\n\r\n    const { firestore } = useFirebase()\r\n    const { id } = useParams()\r\n\r\n    const [products, setProducts] = useState([])\r\n    const [event, setEvent] = useState()\r\n    const [tags, setTags] = useState([])\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const event = (await getDoc(doc(collection(firestore, \"events\"), id))).data()\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setEvent(event)\r\n            setTags(tags)\r\n        })()\r\n\r\n        return () => unsubscribeProducts()\r\n    }, [])\r\n\r\n\r\n    return (\r\n        <Container>\r\n            <h2>Evento {event?.name}</h2>\r\n\r\n            <BtnWrapper>\r\n                <Link to={`/eventos/${id}/nueva-venta`}><Button>Nueva venta</Button></Link>\r\n                <Link to={`/eventos/${id}/resumen`}><Button>Ver resumen</Button></Link>\r\n            </BtnWrapper>\r\n        </Container>\r\n    )\r\n}\r\n\r\nconst BtnWrapper = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    width: 100%;\r\n    justify-content: space-evenly;\r\n\r\n`\r\n\r\nexport default Event","import { get } from 'lodash'\r\n\r\nconst basicSorter = (a, b, key) => {\r\n    const aValue = key ? get(a, key) : a\r\n    const bValue = key ? get(b, key) : b\r\n    if(aValue > bValue){ return 1 }\r\n    else{ return -1 }\r\n}\r\n\r\nexport default basicSorter","import { getDoc, query, collection, getDocs, onSnapshot, doc } from 'firebase/firestore'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase'\r\nimport { useParams, Link } from 'react-router-dom'\r\nimport { Button, Modal, Table } from 'antd'\r\nimport moment from 'moment'\r\nimport { EyeOutlined } from '@ant-design/icons'\r\nimport { basicSorter } from '../utils'\r\n\r\nconst EventStatus = () => {\r\n\r\n    const { firestore } = useFirebase()\r\n    const { id } = useParams()\r\n\r\n    const [products, setProducts] = useState([])\r\n    const [packs, setPacks] = useState([])\r\n    const [sales, setSales] = useState([])\r\n    const [event, setEvent] = useState()\r\n    const [tags, setTags] = useState([])\r\n    const [total, setTotal] = useState()\r\n    const [modalDetalle, setModalDetalle] = useState({\r\n        visible: false\r\n    })\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n        const unsubscribePacks = onSnapshot(\r\n            query(collection(firestore, \"packs\")),\r\n            qs => {\r\n                const packs = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setPacks(packs)\r\n            }\r\n        );\r\n        const unsubscribeSales = onSnapshot(\r\n            query(collection(firestore, `events/${id}/sales`)),\r\n            qs => {\r\n                const sales = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setSales(sales)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            const eventRaw = (await getDoc(doc(collection(firestore, \"events\"), id)))\r\n            const event = {\r\n                id: eventRaw.id,\r\n                ref: eventRaw.ref,\r\n                ...eventRaw.data()\r\n            }\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setEvent(event)\r\n            setTags(tags)\r\n        })()\r\n\r\n        return () => {\r\n            unsubscribeProducts()\r\n            unsubscribePacks()\r\n            unsubscribeSales()\r\n        }\r\n    }, [])\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Fecha\",\r\n            dataIndex: \"createdAt\",\r\n            key: \"date\",\r\n            render: date => moment(date.seconds * 1000).format(\"DD-MM-YYYY HH:mm\"),\r\n            sorter: (a, b) => basicSorter(a?.createdAt, b?.createdAt, \"seconds\")\r\n        },\r\n        {\r\n            title: \"Nº artículos\",\r\n            dataIndex: \"items\",\r\n            key: \"items\",\r\n            render: items => {\r\n                const allItems = items.map(it => it?.subItems ? it.subItems : it).flat()\r\n                return allItems.length\r\n            }\r\n        },\r\n        {\r\n            title: \"Importe\",\r\n            dataIndex: \"total\",\r\n            key: \"total\",\r\n            render: total => total + \"€\",\r\n            sorter: (a, b) => basicSorter(a, b, \"total\")\r\n        },\r\n        {\r\n            key: \"detalleBtn\",\r\n            render: item => (\r\n                <Button\r\n                    onClick={() => {\r\n                        const populatedItem = {\r\n                            ...item,\r\n                            items: (item?.items || []).map(it => {\r\n                                return {\r\n                                    ...it,\r\n                                    name: products.find(p => p.id === it.id)?.name\r\n                                }\r\n                            })\r\n                        }\r\n                        setModalDetalle({\r\n                            visible: true,\r\n                            item: populatedItem\r\n                        })\r\n                    }}\r\n                ><EyeOutlined /></Button>\r\n            )\r\n        }\r\n    ]\r\n\r\n    useEffect(() => {\r\n        const total = sales.reduce((acc, it) => {\r\n            return acc + it?.total\r\n        }, 0)\r\n        setTotal(total + \"€\")\r\n    }, [sales])\r\n\r\n    return (\r\n        <Container>\r\n            <Link to={`/eventos/${id}`}>&lt; Volver</Link>\r\n            <h2>Resumen {event?.name}</h2>\r\n\r\n            <h4>Total: {total}</h4>\r\n            <Table\r\n                columns={columns}\r\n                dataSource={sales}\r\n                rowKey=\"id\"\r\n            />\r\n\r\n            {/* Modal detalle */}\r\n            <Modal\r\n                visible={modalDetalle?.visible}\r\n                footer={null}\r\n                onCancel={() => setModalDetalle({ visible: false })}\r\n            >\r\n                <p><strong>Evento: </strong>{ event?.name }</p>\r\n                <p><strong>Hora: </strong>{ moment(modalDetalle?.item?.createdAt?.seconds, \"X\").format(\"DD-MM-YYYY HH:mm\")}</p>\r\n                <p><strong>Forma de pago: </strong>{ modalDetalle?.item?.paymentMethod}</p>\r\n                { modalDetalle?.item?.description && <p><strong>Notas: </strong>{ modalDetalle?.item?.description }</p> }\r\n\r\n                <h3>Productos</h3>\r\n                <Table\r\n                    rowKey=\"id\"\r\n                    dataSource={(modalDetalle?.item?.items || [])}\r\n                    columns={[\r\n                        {\r\n                            title: \"Nombre\",\r\n                            dataIndex: \"name\",\r\n                            key: \"name\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"name\"),\r\n                        },\r\n                        {\r\n                            title: \"Cantidad\",\r\n                            dataIndex: \"qty\",\r\n                            key: \"qty\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"qty\"),\r\n                        },\r\n                        {\r\n                            title: \"Importe\",\r\n                            dataIndex: \"price\",\r\n                            key: \"price\",\r\n                            render: price => price + \"€\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"price\")\r\n                        }\r\n                    ]}\r\n                />\r\n\r\n                <div style={{ display: \"flex\", justifyContent: \"center\" }}>\r\n                    <Button\r\n                        type=\"primary\"\r\n                        onClick={() => setModalDetalle({ visible: false })}\r\n\r\n                    >Cerrar</Button>\r\n                </div>\r\n\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default EventStatus","import { Button, Modal, Input, Table, Tag, Form, Select, message, DatePicker, Switch } from 'antd'\r\nimport { collection, query, doc, getDocs, getDoc, addDoc, setDoc, deleteDoc, onSnapshot, updateDoc } from \"firebase/firestore\";\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container } from '../components'\r\nimport { useFirebase } from '../context/firebase';\r\nimport { CheckOutlined, CloseOutlined, DeleteOutlined, EditOutlined, ExportOutlined, EyeOutlined } from '@ant-design/icons'\r\nimport _ from 'lodash';\r\nimport estaSeguroDeQue from '../utils/estaSeguroDeQue';\r\nimport { useHistory, Link } from 'react-router-dom';\r\nimport moment from 'moment'\r\nimport { basicSorter } from '../utils';\r\n\r\nconst Reservations = () => {\r\n    const { firestore } = useFirebase()\r\n    const history = useHistory()\r\n\r\n    const [mutateModal, setMutateModal] = useState({ visible: false })\r\n    const [reservations, setReservations] = useState([])\r\n    const [loading, setLoading] = useState(false)\r\n    const [showCompleted, setShowCompleted] = useState(false)\r\n    const [filteredReservations, setFilteredReservations] = useState([])\r\n    const [products, setProducts] = useState([])\r\n    const [pendingProducts, setPendingProducts] = useState([])\r\n    const [detailModal, setDetailModal] = useState({ visible: false })\r\n    const [deliverModal, setDeliverModal] = useState({ visible: false })\r\n\r\n    useEffect(() => {\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n\r\n        \r\n        const unsubscribeReservations = onSnapshot(\r\n            query(collection(firestore, \"reservations\")),\r\n            qs => {\r\n                const reservations = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n\r\n                const pendingProducts = Object.values(_.groupBy(reservations.map(r => r.items).flat(), \"id\")).map(product => {\r\n                    const totalQty = product.reduce((acc, it) => acc + (it?.qty || 0) - (it?.delivered || 0), 0)\r\n                    return {\r\n                        ...product[0],\r\n                        qty: totalQty\r\n                    }\r\n                }).filter(it => it.qty > 0)\r\n                setPendingProducts(pendingProducts)\r\n                setReservations(reservations)\r\n            }\r\n        )\r\n        return () => unsubscribeReservations()\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        setFilteredReservations((reservations || []).filter(r => r.completed === showCompleted))\r\n    }, [reservations, showCompleted])\r\n\r\n    const [form] = Form.useForm()\r\n\r\n    // const createReservation = async () => {\r\n    //     try{\r\n    //         setLoading(true)\r\n    //         const { name, date } = form.getFieldsValue(true)\r\n    //         const added = await addDoc(collection(firestore, \"reservations\"), {\r\n    //             name,\r\n    //             date: date.toDate()\r\n    //         })\r\n    //         setMutateModal({ visible: false })\r\n    //         message.success(\"La reserva se ha creado correctamente\")\r\n    //         setLoading(false)\r\n    //     } catch(err) {\r\n    //         console.log(err)\r\n    //         message.error(\"Ocurrió un error durante la creación de la reserva\")\r\n    //         setLoading(false)\r\n    //     }\r\n    // }\r\n    // const updateReservation = async id => {\r\n    //     try{\r\n    //         setLoading(true)\r\n    //         const { name, date } = form.getFieldsValue(true)\r\n    //         const updated = await setDoc(doc(firestore, \"reservations\", id), {\r\n    //             name,\r\n    //             date: date.toDate()\r\n    //         })\r\n    //         setMutateModal({ visible: false })\r\n    //         message.success(\"La reserva se ha editado correctamente\")\r\n    //     } catch(err) {\r\n    //         console.log(err)\r\n    //         message.error(\"Ocurrió un error durante la edición de la reserva\")\r\n    //         setLoading(false)\r\n    //     }\r\n    // }\r\n    const deleteReservation = async id => {\r\n        try{\r\n            const deleted = await deleteDoc(doc(firestore, \"reservations\", id))\r\n            message.success(\"La reserva se ha eliminado correctamente\")\r\n        } catch(err) {\r\n            console.log(err)\r\n            message.error(\"Ocurrió un error durante el borrado de la reserva\")\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const toggleCompleted = async item => {\r\n        const updated = await updateDoc(doc(firestore, \"reservations\", item.id), {\r\n            completed: !item?.completed\r\n        })\r\n    }\r\n\r\n    const columns = [\r\n        {\r\n            title: \"Nombre\",\r\n            dataIndex: \"name\",\r\n            key: \"name\",\r\n            sorter: (a, b) => basicSorter(a?.name, b?.name)\r\n        },\r\n        {\r\n            title: \"Forma de contacto\",\r\n            dataIndex: \"reservationMethod\",\r\n            key: \"reservationMethod\",\r\n            sorter: (a, b) => basicSorter(a?.reservationMethod, b?.reservationMethod)\r\n        },\r\n        {\r\n            title: \"Dirección/Número\",\r\n            dataIndex: \"address\",\r\n            key: \"address\",\r\n            sorter: (a, b) => basicSorter(a?.address, b?.address)\r\n        },\r\n        {\r\n            title: \"Fecha de reserva\",\r\n            dataIndex: \"createdAt\",\r\n            key: \"createdAt\",\r\n            sorter: (a, b) => {\r\n                const aDate = a.createdAt.toDate()\r\n                const bDate = b.createdAt.toDate()\r\n                return basicSorter(aDate, bDate)\r\n            },\r\n            render: it => moment(it.toDate()).format(\"DD-MM-YYYY HH:mm\")\r\n        },\r\n        {\r\n            title: \"Productos\" + (!showCompleted ? \" pendientes\" : \"\"),\r\n            key: \"products\",\r\n            render: res => (\r\n                <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n                    {(res.items || []).filter(it => {\r\n                        return showCompleted || (it.qty > (it.delivered || 0))\r\n                    }).map(it => {\r\n                        const name = (products || []).find(prod => prod.id === it.id)?.name\r\n                        return <span key={`item-${res.id}-${it.id}`}>{showCompleted ? it.qty : (parseInt(it.qty) - parseInt(it.delivered || 0))}x {name}</span>\r\n                    })}\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            title: \"Opciones\",\r\n            render: item => {\r\n                return (\r\n                    <div style={{ display: \"flex\" }}>\r\n                        <Tag\r\n                            onClick={() => {\r\n                                setDetailModal({\r\n                                    visible: true,\r\n                                    item\r\n                                })\r\n                            }}\r\n                        ><EyeOutlined /></Tag>\r\n                        &nbsp;\r\n                        <Tag onClick={() => setDeliverModal({ visible: true, item })}><ExportOutlined /></Tag>\r\n                        &nbsp;\r\n                        { !item?.completed && (\r\n                            <Tag \r\n                                color=\"volcano\"\r\n                                onClick={() => {\r\n                                    estaSeguroDeQue({\r\n                                        desea: \"eliminar\",\r\n                                        esto: `la reserva de ${item.name}`,\r\n                                        loading,\r\n                                        fn: async () => {\r\n                                            setLoading(true)\r\n                                            await deleteReservation(item.id)\r\n                                            setLoading(false)\r\n                                        }\r\n                                    })\r\n                                }}\r\n                            ><DeleteOutlined /></Tag>\r\n                        )}\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ]\r\n\r\n    const productColumns = [\r\n        {\r\n            title: \"Nombre\",\r\n            key: \"name\",\r\n            sorter: (a, b) => {\r\n                const aName = (products || []).find(prod => prod.id === a.id)?.name\r\n                const bName = (products || []).find(prod => prod.id === b.id)?.name\r\n                basicSorter(aName, bName)\r\n            },\r\n            render: p => {\r\n                const relatedProduct = (products || []).find(prod => prod?.id === p?.id)\r\n                return relatedProduct?.name\r\n            }\r\n        },\r\n        {\r\n            title: \"Número de unidades\",\r\n            key: \"qty\",\r\n            dataIndex: \"qty\",\r\n            sorter: (a, b) => basicSorter(a, b, \"qty\" )\r\n        }\r\n    ]\r\n\r\n    const deliverProducts = async ({ reservation, deliveredProducts, complete }) => {\r\n        if(complete){\r\n            estaSeguroDeQue({\r\n                desea: \"entregar\",\r\n                esto: \"el pedido completo\",\r\n                fn: async () => {\r\n                    const itemsMod = reservation.items.map(it => {\r\n                        return {\r\n                            ...it,\r\n                            delivered: it.qty\r\n                        }\r\n                    })\r\n                    await updateDoc(doc(firestore, \"reservations\", reservation.id), {\r\n                        items: itemsMod,\r\n                        completed: true\r\n                    })\r\n                    setDeliverModal({ visible: false })\r\n                }\r\n            })\r\n        }\r\n        else {\r\n            estaSeguroDeQue({\r\n                desea: \"entregar\",\r\n                esto: \"los productos seleccionados\",\r\n                fn: async () => {\r\n                    if(!deliveredProducts || (Array.isArray(deliveredProducts) && deliveredProducts.every(dp => dp.qty === 0 || dp.qty === \"0\"))){\r\n                        message.error(\"No hay ningún producto marcado para entregar (todas las cantidades son cero)\")\r\n                    }\r\n                    else if(deliveredProducts.some(dp => dp.qty < 0)){\r\n                        message.error(\"La cantidad de producto no puede ser inferior a cero\")\r\n                    }\r\n                    else {\r\n                        const itemsMod = reservation.items.map(it => {\r\n                            const thisTimeDelivered = deliveredProducts.find(dp => dp.id === it.id)?.qty || 0\r\n                            return {\r\n                                ...it,\r\n                                delivered: parseInt(it.delivered || 0) + parseInt(thisTimeDelivered)\r\n                            }\r\n                        })\r\n                        if(itemsMod.some(it => it.qty < it.delivered)){\r\n                            message.error(\"La cantidad de productos entregados supera la cantidad reservada\")\r\n                        }\r\n                        else{\r\n                            const completed = itemsMod.every(it => parseInt(it.qty) === parseInt(it.delivered))\r\n                            await updateDoc(doc(firestore, \"reservations\", reservation.id), {\r\n                                items: itemsMod,\r\n                                completed\r\n                            })\r\n                            setDeliverModal({ visible: false })\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <h2>Reservas</h2>\r\n            <div style={{ display: \"flex\", justifyContent: \"center\", width: \"100%\" }}>\r\n                <div>\r\n                    <Link to=\"/nueva-reserva\"><Button>Crear reserva</Button></Link>\r\n                    <Button onClick={() => setShowCompleted(!showCompleted)}>Mostrar { showCompleted ? \"sin completar\" : \"completadas\"}</Button>\r\n                </div>\r\n            </div>\r\n\r\n            <br />\r\n\r\n            <div\r\n                style={{ width: \"100%\", overflowX: \"auto\" }}\r\n            >\r\n                <Table\r\n                    dataSource={filteredReservations}\r\n                    rowKey=\"id\"\r\n                    columns={columns}\r\n                />\r\n            </div>\r\n\r\n            <br />\r\n            \r\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", width: \"100%\" }}>\r\n                <h2>Productos pendientes de entrega</h2>\r\n            </div>\r\n\r\n            <div\r\n                style={{ width: \"100%\", overflowX: \"auto\" }}\r\n            >\r\n                <Table\r\n                    dataSource={pendingProducts}\r\n                    rowKey=\"id\"\r\n                    columns={productColumns}\r\n                />\r\n            </div>\r\n\r\n            <Modal\r\n                visible={detailModal?.visible}\r\n                footer={null}\r\n                onCancel={() => setDetailModal({ visible: false })}\r\n            >\r\n                <p><string><strong>Nombre:</strong> {detailModal?.item?.name}</string></p>\r\n                <p><string><strong>Forma de contacto:</strong> {detailModal?.item?.reservationMethod}</string></p>\r\n                <p><string><strong>Dirección/Número:</strong> {detailModal?.item?.address}</string></p>\r\n                { detailModal?.item?.observations && <p><string><strong>Observaciones:</strong> {detailModal?.item?.observations}</string></p> }\r\n\r\n                <h4>Productos</h4>\r\n                <Table\r\n                    columns={[\r\n                        {\r\n                            title: \"Nombre\",\r\n                            key: \"name\",\r\n                            sorter: (a, b) => {\r\n                                const aName = (products || []).find(prod => prod.id === a.id)?.name\r\n                                const bName = (products || []).find(prod => prod.id === b.id)?.name\r\n                                basicSorter(aName, bName)\r\n                            },\r\n                            render: p => {\r\n                                const relatedProduct = (products || []).find(prod => prod?.id === p?.id)\r\n                                return relatedProduct?.name\r\n                            }\r\n                        },\r\n                        {\r\n                            title: \"Cantidad\",\r\n                            dataIndex: \"qty\",\r\n                            key: \"qty\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"qty\")\r\n                        },\r\n                    ]}\r\n                    dataSource={detailModal?.item?.items || []}\r\n                />\r\n\r\n                <Button onClick={() => setDetailModal({ visible: false })}>Cerrar</Button>\r\n            </Modal>\r\n\r\n            <Modal\r\n                visible={deliverModal?.visible}\r\n                footer={null}\r\n                onCancel={() => setDeliverModal({ visible: false })}\r\n            >\r\n                <h4>Entrega de productos</h4>\r\n                <Table\r\n                    columns={[\r\n                        {\r\n                            title: \"Nombre\",\r\n                            key: \"name\",\r\n                            render: p => {\r\n                                const relatedProduct = (products || []).find(prod => prod?.id === p?.id)\r\n                                return relatedProduct?.name\r\n                            }\r\n                        },\r\n                        {\r\n                            title: \"Cantidad\",\r\n                            dataIndex: \"qty\",\r\n                            key: \"qty\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"qty\")\r\n                        },\r\n                        {\r\n                            title: \"Ya entregadas\",\r\n                            dataIndex: \"delivered\",\r\n                            key: \"delivered\",\r\n                            sorter: (a, b) => basicSorter(a, b, \"delivered\"),\r\n                            render: n => n || 0\r\n                        },\r\n                        {\r\n                            title: \"Se entregan\",\r\n                            key: \"deliveredQty\",\r\n                            render: item => {\r\n                                return (\r\n                                    <Input\r\n                                        type=\"number\"\r\n                                        value={(deliverModal?.deliverQtys || []).find(dq => dq.id === item.id)?.qty || 0}\r\n                                        onChange={evt => {\r\n                                            setDeliverModal({\r\n                                                ...deliverModal,\r\n                                                deliverQtys: [\r\n                                                    ...(deliverModal.deliverQtys || []).filter(dq => dq.id !== item.id),\r\n                                                    {\r\n                                                        id: item.id,\r\n                                                        qty: evt.target.value\r\n                                                    }\r\n                                                ]\r\n                                            })\r\n                                        }}\r\n                                    />\r\n                                )\r\n                            }\r\n                        }\r\n                    ]}\r\n                    dataSource={deliverModal?.item?.items || []}\r\n                    rowKey=\"id\"\r\n                />\r\n\r\n                <div style={{ width: \"100%\", display: \"flex\", justifyContent: \"space-evenly\" }}>\r\n                    <Button onClick={() => setDeliverModal({ visible: false })}>Cerrar</Button>\r\n                    <Button \r\n                        type=\"primary\"\r\n                        onClick={() => deliverProducts({\r\n                            reservation: deliverModal.item,\r\n                            deliveredProducts: deliverModal.deliverQtys\r\n                        })}\r\n                    >Entregar</Button>\r\n                    <Button \r\n                        type=\"primary\"\r\n                        onClick={() => deliverProducts({\r\n                            reservation: deliverModal.item,\r\n                            complete: true\r\n                        })}\r\n                    >Entregar todo</Button>\r\n                </div>\r\n            </Modal>\r\n            \r\n        </Container>\r\n    )\r\n}\r\n\r\nexport default Reservations","import { getDoc, query, collection, addDoc, onSnapshot, doc } from 'firebase/firestore'\r\nimport React, { useEffect, useState } from 'react'\r\nimport { Container, ProductBtn, PackBtn } from '../components'\r\nimport { useFirebase } from '../context/firebase'\r\nimport { useParams, useHistory, Link } from 'react-router-dom'\r\nimport { Radio, Button, Modal, Form, Select, Input, message } from 'antd'\r\nimport styled from 'styled-components'\r\nimport _ from 'lodash'\r\n\r\nconst Event = () => {\r\n\r\n    const { firestore } = useFirebase()\r\n    const { id } = useParams()\r\n    const [formEnd] = Form.useForm()\r\n    const history = useHistory()\r\n\r\n    const [products, setProducts] = useState([])\r\n    const [packs, setPacks] = useState([])\r\n    const [filteredProducts, setFilteredProducts] = useState([])\r\n    const [event, setEvent] = useState()\r\n    const [tags, setTags] = useState([])\r\n    const [selectedTag, setSelectedTag] = useState()\r\n    const [saleStatus, setSaleStatus] = useState({})\r\n    const [packItems, setPackItems] = useState([])\r\n    const [modalPackSelector, setModalPackSelector] = useState({ visible: false })\r\n    const [modalEndSale, setModalEndSale] = useState({ visible: false })\r\n    const [modalTotal, setModalTotal] = useState()\r\n    const [paymentMethod, setPaymentMethod] = useState()\r\n    const [reservationMethod, setReservationMethod] = useState()\r\n    const [inputMoney, setInputMoney] = useState()\r\n    const [loadingSale, setLoadingSale] = useState(false)\r\n    const [isReservation, setReservation] = useState(false)\r\n\r\n    const filterByTag = (products, tag) => {\r\n        const filteredProducts = products\r\n            .filter(p => !tag || p.tags.includes(selectedTag))\r\n            .sort((a, b) => a.tags[0] > b.tags[1] ? 1 : -1)\r\n            .sort((a, b) => a.name > b.name ? 1 : -1)\r\n        setFilteredProducts(filteredProducts)\r\n    }\r\n\r\n    const mutateStatus = (product, delta, pack) => {\r\n        const oldQty = saleStatus[product]\r\n        let saleStatusMod = {...saleStatus}\r\n        const newQty = (oldQty || 0) + delta\r\n        if(newQty < 1){\r\n            saleStatusMod = _.omit(saleStatusMod, [product])\r\n        } else {\r\n            if(pack){\r\n                saleStatusMod = _.omit(saleStatusMod, [product])\r\n            }\r\n            else {\r\n                saleStatusMod[product] = newQty\r\n            }\r\n        }\r\n        setSaleStatus(saleStatusMod)\r\n    }\r\n\r\n    useEffect(() => {\r\n        const isReservation = history.location.pathname === \"/nueva-reserva\"\r\n        setReservation(isReservation)\r\n\r\n        const unsubscribeProducts = onSnapshot(\r\n            query(collection(firestore, \"products\")),\r\n            qs => {\r\n                const products = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setProducts(products)\r\n            }\r\n        );\r\n        const unsubscribePacks = onSnapshot(\r\n            query(collection(firestore, \"packs\")),\r\n            qs => {\r\n                const packs = qs.docs.map(doc => ({ ...doc.data(), id: doc.id }))\r\n                setPacks(packs)\r\n            }\r\n        );\r\n\r\n        (async () => {\r\n            if(!isReservation){\r\n                const event = (await getDoc(doc(collection(firestore, \"events\"), id))).data()\r\n                setEvent(event)\r\n            }\r\n            const config = (await getDoc(doc(collection(firestore, \"config\"), \"1\"))).data()\r\n            const tags = config?.tags || []\r\n            setTags(tags)\r\n        })()\r\n\r\n        return () => {\r\n            unsubscribeProducts()\r\n            unsubscribePacks()\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        filterByTag(products, selectedTag)\r\n    }, [products, selectedTag])\r\n\r\n    useEffect(() => {\r\n        if(modalEndSale.visible){\r\n            setModalTotal(calculateTotal())\r\n        }\r\n    }, [modalEndSale])\r\n\r\n    const calculateTotal = () => {\r\n        const reducito = Object.entries(saleStatus).reduce((acc, it) => {\r\n            const product = [...products, ...packs].find(p => p.id === it[0])\r\n            return acc + (product.price * (it[1]?.qty || it[1]))\r\n        }, 0)\r\n        return reducito\r\n    }\r\n\r\n    return (\r\n        <Container>\r\n            <Link to={`/eventos/${id}`}>&lt; Volver</Link>\r\n            <h2>Nueva {isReservation ? \"reserva\" : `venta {event?.name}`}</h2>\r\n\r\n            <Button\r\n                onClick={() => setModalEndSale({\r\n                    visible: true\r\n                })}\r\n            >Acabar {isReservation ? \"reserva\" : \"venta\"}</Button>\r\n\r\n            <br />\r\n\r\n            <h4>Productos</h4>\r\n            <Radio.Group\r\n                onChange={evt => setSelectedTag(evt.target.value)}\r\n                value={selectedTag}\r\n                style={{ display: \"flex\", flexWrap: \"wrap\", justifyContent: \"center\" }}\r\n            >\r\n                { [...tags, \"Packs\"].map((t, i) => {\r\n                    return (\r\n                        <Radio.Button \r\n                            key={\"tag-\"+i}\r\n                            value={t}\r\n                            onClick={() => t === selectedTag && setSelectedTag(undefined)}\r\n                        >{t}</Radio.Button>\r\n                    )\r\n                })}\r\n            </Radio.Group>\r\n\r\n            <br />\r\n\r\n            { selectedTag !== \"Packs\" && (\r\n                <div>\r\n                    <ProductWrapper>\r\n                        { filteredProducts.map(fp => {\r\n                            return (\r\n                                <ProductBtn\r\n                                    key={`fp-${fp.id}`}\r\n                                    product={fp}\r\n                                    mutateStatus={mutateStatus}\r\n                                    qty={saleStatus[fp.id] || 0}\r\n                                />\r\n                            )\r\n                        })}\r\n                    </ProductWrapper>\r\n                     <br />\r\n                </div>\r\n            )}\r\n\r\n            <h4>Packs</h4>\r\n            <ProductWrapper>\r\n                { packs.map(p => {\r\n                    return (\r\n                        <ProductBtn\r\n                            key={`pack-${p.id}`}\r\n                            product={p}\r\n                            mutateStatus={mutateStatus}\r\n                            qty={saleStatus[p.id] || 0}\r\n                            modalPack={modalPackSelector}\r\n                            setModalPack={setModalPackSelector}\r\n                        />\r\n                    )\r\n                })}\r\n            </ProductWrapper>\r\n\r\n            <Modal\r\n                visible={modalPackSelector?.visible}\r\n                onCancel={() => setModalPackSelector({ visible: false })}\r\n                footer={null}\r\n            >\r\n                <ProductWrapper>\r\n                    {(products.filter(p => p.tags.includes(modalPackSelector?.pack?.tag)) || []).map(p => {\r\n                        return (\r\n                            <PackBtn\r\n                                key={`pack-${p.id}`}\r\n                                pack={modalPackSelector?.pack}\r\n                                product={p}\r\n                                packItems={packItems}\r\n                                setPackItems={setPackItems}\r\n                                qty={packItems.length || 0}\r\n                            />\r\n                        )\r\n                    })}\r\n                </ProductWrapper>\r\n                <br />\r\n                <ProductWrapper>\r\n                    <Button onClick={() => {\r\n                        setModalPackSelector({ visible: false })\r\n                        setPackItems([])\r\n                    }}>Cancelar</Button>\r\n                    <Button\r\n                        disabled={packItems.length < modalPackSelector?.pack?.units}\r\n                        type=\"primary\"\r\n                        onClick={() => {\r\n                            const newStatus = {\r\n                                ...saleStatus,\r\n                                [modalPackSelector?.pack?.id]: {\r\n                                    qty: (saleStatus[modalPackSelector?.pack?.id]?.qty || 0) + 1,\r\n                                    items: [\r\n                                        ...(modalPackSelector?.pack?.items || []),\r\n                                        ...packItems\r\n                                    ]\r\n                                }\r\n                            }\r\n                            setSaleStatus(newStatus)\r\n                            setModalPackSelector({ visible: false })\r\n                            setPackItems([])\r\n                        }}\r\n                    >Aceptar</Button>\r\n                </ProductWrapper>\r\n            </Modal>\r\n\r\n            <Modal\r\n                visible={modalEndSale?.visible}\r\n                onCancel={() => setModalEndSale({ visible: false })}\r\n                footer={null}\r\n            >\r\n                <h2>Total: { modalTotal }€</h2>\r\n\r\n                <Form\r\n                    form={formEnd}\r\n                    layout=\"vertical\"\r\n                >\r\n                    <Form.Item\r\n                        name=\"name\"\r\n                        label=\"Nombre del cliente\"\r\n                        rules={isReservation ? [{ required: true }] : []}\r\n                    >\r\n                        <Input />\r\n                    </Form.Item>\r\n                    { isReservation && (\r\n                        <Form.Item\r\n                            label=\"Método de contacto\"\r\n                            rules={[{ required: true }]}\r\n                        >\r\n                            <Select\r\n                                onChange={evt => {\r\n                                    setReservationMethod(evt)\r\n                                }}\r\n                            >\r\n                                <Select.Option value=\"Email\">Email</Select.Option>\r\n                                <Select.Option value=\"Instagram\">Instagram</Select.Option>\r\n                                <Select.Option value=\"Teléfono/Whatsapp\">Teléfono/Whatsapp</Select.Option>\r\n                                <Select.Option value=\"Otros\">Otros</Select.Option>\r\n                            </Select>\r\n                        </Form.Item>\r\n                    )}\r\n                    { isReservation && (\r\n                        <Form.Item\r\n                            name=\"address\"\r\n                            label=\"Dirección/Número\"\r\n                            rules={[{ required: true }]}\r\n                            >\r\n                            <Input />\r\n                        </Form.Item>\r\n                    )}\r\n                    { !isReservation && (\r\n                        <Form.Item\r\n                            name=\"paymentMethod\"\r\n                            label=\"Forma de pago\"\r\n                            rules={[{ required: true }]}\r\n                            >\r\n                            <Select\r\n                                onChange={evt => {\r\n                                    setPaymentMethod(evt)\r\n                                }}\r\n                                >\r\n                                <Select.Option value=\"Efectivo\">Efectivo</Select.Option>\r\n                                <Select.Option value=\"Bizum\">Bizum</Select.Option>\r\n                            </Select>\r\n                        </Form.Item>\r\n                    )}\r\n                    <Form.Item\r\n                        name=\"observations\"\r\n                        label=\"Observaciones\"\r\n                    >\r\n                        <Input.TextArea />\r\n                    </Form.Item>\r\n\r\n                    { paymentMethod === \"Efectivo\" && (\r\n                        <div>\r\n                            <Form.Item\r\n                                label=\"Me pagan...\"\r\n                            >\r\n                                <Input\r\n                                    type=\"number\"\r\n                                    onChange={evt => setInputMoney(evt.target.value)}\r\n                                    suffix=\"€\"\r\n                                ></Input>\r\n                            </Form.Item>\r\n\r\n                            <Form.Item\r\n                                label=\"Devuelvo\"\r\n                            >\r\n                                <Input\r\n                                    disabled\r\n                                    type=\"number\"\r\n                                    suffix=\"€\"\r\n                                    value={inputMoney && (inputMoney - modalTotal)}\r\n                                />\r\n                            </Form.Item>\r\n                        </div>\r\n                    )}\r\n                </Form>\r\n\r\n                <br />\r\n\r\n                <BtnWrapper>\r\n                    <Button onClick={() => {\r\n                        setModalEndSale({ visible: false })\r\n                        setModalTotal()\r\n                    }}>Cancelar</Button>\r\n                    <Button\r\n                        loading={loadingSale}\r\n                        type=\"primary\"\r\n                        onClick={async () => {\r\n                            setLoadingSale(true)\r\n                            try{\r\n\r\n                                const dataForm = formEnd.getFieldsValue()\r\n\r\n                                const items = Object.entries(saleStatus).map(ss => {\r\n                                    const item = [...products, ...packs].find(p => p.id === ss[0])\r\n                                    const isPack = !!(ss[1]?.items)\r\n                                    const subItems = isPack && { subItems: (ss[1].items.map(it => ({\r\n                                        id: it,\r\n                                        ref: doc(firestore, \"products\", it)\r\n                                    })))}\r\n                                    \r\n                                    return {\r\n                                        id: ss[0],\r\n                                        ref: doc(firestore, isPack ? \"packs\" : \"products\", ss[0]),\r\n                                        qty: ss[1]?.qty || ss[1],\r\n                                        price: item.price,\r\n                                        ...subItems\r\n                                    }\r\n                                })\r\n                                const sale = {\r\n                                    createdAt: new Date(),\r\n                                    ...(paymentMethod ? { paymentMethod: paymentMethod } : {}),\r\n                                    ...(reservationMethod ? { reservationMethod: reservationMethod } : {}),\r\n                                    total: calculateTotal(),\r\n                                    ...dataForm,\r\n                                    completed: !isReservation,\r\n                                    items: items.map(it => {\r\n                                        if(isReservation){ return { ...it, delivered: 0 }}\r\n                                        else { return it }\r\n                                    })\r\n                                }\r\n\r\n                                if(isReservation){\r\n                                    await addDoc(collection(firestore, \"reservations\"), sale)\r\n                                } else {\r\n                                    const docRef = doc(firestore, \"events\", id);\r\n                                    const colRef = collection(docRef, \"sales\")\r\n                                    await addDoc(colRef, sale);\r\n                                }\r\n                                message.success(`La ${isReservation ? \"reserva\" : \"venta\"} se ha guardado correctamente`)\r\n                                history.push(isReservation ? \"/reservas\" : `/eventos/${id}`)\r\n                            } catch(err) {\r\n                                console.log(err)\r\n                                message.error(`Ocurrió un error durante el guardado de la ${isReservation ? \"reserva\" : \"venta\"}`)\r\n                            }\r\n                            setLoadingSale(false)\r\n                        }}\r\n                    >Aceptar</Button>\r\n                </BtnWrapper>\r\n            </Modal>\r\n        </Container>\r\n    )\r\n}\r\n\r\nconst ProductWrapper = styled.div`\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    justify-content: center;\r\n`\r\n\r\nconst BtnWrapper = styled.div`\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: space-evenly;\r\n`\r\n\r\nexport default Event","import React, { useState } from \"react\";\r\nimport { Redirect, Switch, Route } from \"react-router-dom\";\r\nimport { Home, Login, Register, Products, Events, Event, NewSale, EventStatus, Reservations } from \"./pages\"\r\nimport { useAuthentication } from \"./context/authentication\";\r\n\r\nexport const App = () => {\r\n  const { isFetchingUser, isLogged } = useAuthentication();\r\n\r\n  if (!isLogged && isFetchingUser) return <h1>Cargando...</h1>;\r\n\r\n  return isLogged ? <AuthenticatedApp /> : <UnauthenticatedApp />;\r\n};\r\n\r\nconst AuthenticatedApp = () => {\r\n  const { isLogged } = useAuthentication();\r\n\r\n  if (!isLogged) return <Redirect to=\"/login\" />;\r\n\r\n  return (\r\n    <Switch>\r\n      <Route path=\"/productos\" exact><Products /></Route>\r\n      <Route path=\"/eventos\" exact><Events /></Route>\r\n      <Route path=\"/eventos/:id/nueva-venta\" exact><NewSale /></Route>\r\n      <Route path=\"/nueva-reserva\" exact><NewSale /></Route>\r\n      <Route path=\"/eventos/:id/resumen\" exact><EventStatus /></Route>\r\n      <Route path=\"/eventos/:id\" exact><Event /></Route>\r\n      <Route path=\"/reservas\" exact><Reservations /></Route>\r\n      <Route path=\"/\" exact><Home /></Route>\r\n      <Route path=\"*\">Error 404 - Page not found!</Route>\r\n    </Switch>\r\n  );\r\n};\r\n\r\nconst UnauthenticatedApp = () => {\r\n  return (\r\n    <Switch>\r\n      <Route exact path={[\"/\", \"/login\"]}>\r\n        <Login />\r\n      </Route>\r\n      <Route exact path=\"/register\">\r\n        <Register />\r\n      </Route>\r\n    </Switch>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { BrowserRouter } from \"react-router-dom\";\r\nimport { FirebaseProvider } from \"./context/firebase\";\r\nimport { AuthenticationProvider } from \"./context/authentication\";\r\n\r\ntype RootProviderProps = {\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport const RootProvider = ({ children }: RootProviderProps) => {\r\n  return (\r\n    <BrowserRouter>\r\n      <FirebaseProvider>\r\n        <AuthenticationProvider>{children}</AuthenticationProvider>\r\n      </FirebaseProvider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { App } from \"./app\";\r\nimport { RootProvider } from \"./rootProviders\";\r\nimport 'antd/dist/antd.css'\r\nimport './style.css'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <RootProvider>\r\n      <App />\r\n    </RootProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}